var e,t;e=this,t=function(e){
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
function t(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s}function n(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function i(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s}function o(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))}function r(e,t){let n=s[e]||"Unknown error";return void 0!==t&&(n+=": "+t),Error(n)}const s={0:"[ActivationContext] Invalid path",1:"[ViewActivity] Render context not found (not a child component?)",2:"[ViewActivity] Application instance not found",3:"[ViewActivity] Dialog builder not found",4:"Invalid ViewComponent child component",5:"[ViewComponent] Render context not found (not a child component?)",6:"[Binding] Unknown binding filter",7:"[Binding] Binding not found for",8:"[Binding] Bound parent binding not found for",9:"[Binding] Component not bound",10:"[Format] Cannot convert object value to string",11:"[Format] Invalid format type",12:"[Component] Not an event handler method",13:"[Component] Invalid event handler preset",14:"[List] Symbol not supported",15:"[List] Existing objects are not of given type",16:"[List] Cannot add objects to a destroyed list",17:"[List] Cannot insert object that is already in this list",18:"[List] Object not found",19:"[List] Index out of bounds",20:"[Map] Existing objects are not of given type",21:"[Map] Cannot add objects to a destroyed map",22:"[Object] Cannot add event handler to base class",23:"[Object] Argument is not a managed event",24:"[Object] Event recursion limit reached",25:"[Object] Cannot deactivate managed object",26:"[Object] Managed object is already destroyed",27:"[Object] State transition cancelled",28:"[Object] Invalid object reference",29:"[Object] Referenced object has been destroyed",30:"[Object] Can only create managed properties on managed object instances",31:"[Object] Cannot turn properties with getters and/or setters into managed references",32:"[Object] Property is not writable",33:"[Record] Property is not serializable",34:"[Object] Existing reference is not of given type",35:"[Service] Missing property name",36:"[Service] Service name cannot be blank",37:"[Object] Cannot observe events on parent reference",38:"[Object] Shadow observable can only be added to properties with getters",39:"[Object] Rate limit can only be applied to async handlers",40:"[Object] Recursion in observer constructor detected",41:"[Object] Synchronous observers are not allowed for property",42:"[Object] Property is already managed in a base class",43:"[Style] Invalid style set instance",44:"[Menu] Builder not found",45:"[Modal] modal property cannot be bound"};class ManagedEvent{constructor(e=""){this.name=e}freeze(){return Object.freeze&&Object.freeze(this),this}}class ManagedCoreEvent extends ManagedEvent{constructor(){super(...arguments),this._coreEventMarker=!0}static isCoreEvent(e){return!!e._coreEventMarker}}!function(e){e.ACTIVE=new e("Active").freeze(),e.INACTIVE=new e("Inactive").freeze(),e.DESTROYED=new e("Destroyed").freeze()}(ManagedCoreEvent||(ManagedCoreEvent={}));class ManagedParentChangeEvent extends ManagedCoreEvent{constructor(e,t){super("ManagedParentChange"),this.parent=e,this.propertyName=t}}class ManagedChangeEvent extends ManagedEvent{constructor(e="Change"){super(e)}}const a=(new ManagedChangeEvent).freeze();class ManagedListChangeEvent extends ManagedChangeEvent{constructor(e="ManagedListChange",t){super(e),this.source=t}}class ManagedObjectAddedEvent extends ManagedListChangeEvent{constructor(e,t,n){super("ManagedObjectAdded",e),this.object=t,this.key=n}}class ManagedObjectRemovedEvent extends ManagedListChangeEvent{constructor(e,t,n){super("ManagedObjectRemoved",e),this.object=t,this.key=n}}function l(e,t,n,i,o){let s,a=t,l=!1,c=o;const d=(i,a,c)=>{s=Object.getOwnPropertyDescriptor(e,i);let h=s,u=e;for(;;){if(!h||a){if(u=Object.getPrototypeOf(u),!u)return;h=u&&Object.getOwnPropertyDescriptor(u,i)}if(h){let e=h.get;if(e){if(!n&&e["-async"])throw r(41);if(e["-shadow"])return t=e["-shadow"],l=!0,d(t,a,!0);c||o||h.set&&h.set["^-ch"]||(o=e)}return h}}};if(d(t),s&&s.set&&s.set["^-ch"]){let n=s.set["^-ch"];return o&&Object.defineProperty(e,t,Object.assign(Object.assign({},s),{get:o})),void(s.set["^-ch"]=()=>{let e=n();return{getter:o||e.getter,setter:e.setter,makeHandler:(t,n,o)=>i(t,n,e&&e.makeHandler(t,n,o))}})}let h=function(e){let n,i=h["^-ch"](),r=i.makeHandler(this,t),c=function(e){i.setter&&i.setter.call(this,e),r(n=e,void 0,r)},d=i.getter;if(!d)if(l){let e;d=function(){if(e)return n;e=!0;try{return this[a]}finally{e=!1}}}else d=o||(()=>n);Object.defineProperty(this,t,{configurable:!0,enumerable:!s||s.enumerable,get:d,set:c}),void 0!==e&&c.call(this,e)};h["^-ch"]=()=>{let e=d(a,!0),n=e&&e.set&&e.set["^-ch"]&&e.set["^-ch"]();if(n&&n.getter&&c)throw r(42,t);return{getter:o||n&&n.getter,setter:n?n.setter:e&&e.set,makeHandler:(e,t,o)=>i(e,t,n&&n.makeHandler(e,t,o))}};let u=o||(()=>s&&s.value);Object.defineProperty(e,t,{configurable:!0,enumerable:!s||s.enumerable,get:u,set:h})}function c(e,t,...n){let i,o=!n[0]||"function"!=typeof n[0]||n[0].prototype instanceof ManagedEvent||n[0]===ManagedEvent?void 0:n[0];const r=o?function(e,t){if(i===e||!this["^$"])return;let n=o.call(this,e,t);n&&(Array.isArray(n)?n.forEach((e=>{ManagedCoreEvent.isCoreEvent(e)||this.emit(i=e)})):ManagedCoreEvent.isCoreEvent(n)||this.emit(i=n),i=void 0)}:function(e){i!==e&&this["^$"]&&(n.length&&!n.some((t=>e===t||"function"==typeof t&&e instanceof t))||ManagedCoreEvent.isCoreEvent(e)||(this.emit(i=e),i=void 0))};Object.defineProperty(e,"^-ec",{configurable:!0,enumerable:!1,value:r}),t||Object.defineProperty(e,"^-en",{configurable:!0,enumerable:!1,value:r})}let d=()=>{},h=1e3;const u="^o:uid",p=Promise.resolve();function m(e,t){let n=!0;e._addInitializer((function(){let i="function"==typeof t?t():e[t];i&&(n&&function(e,t){const n=(n,i,r)=>{!function(e,t,n,i,r){if(r){let r,s,a,l=i["^o:rate"];t.addEventHandler((function(t){return o(this,void 0,void 0,(function*(){if(!n||n(t))try{if(l>=0){if(s=t,r)return;r=!0;let e=Date.now(),n=a+l-e;n>0?yield new Promise((e=>{setTimeout(e,n)})):yield p,a=Date.now(),r=!1,t=s}else yield p;s=void 0;let n=y(this,e);t&&(yield i.call(n,t))}catch(e){d(e)}}))}))}else t.addEventHandler((function(t){if(!n||n(t)){let n=y(this,e);try{i.call(n,t)}catch(e){d(e)}}}))}(t,e,n,i,r)},i=(e,t)=>{let i=function(t){e.call(this,t.parent,t,"managedParent")};i["^o:rate"]=e["^o:rate"],n((e=>e instanceof ManagedParentChangeEvent),i,t)};let s=e.prototype;for(let e of Object.getOwnPropertyNames(t.prototype)){if(!Object.prototype.hasOwnProperty.call(t.prototype,e))continue;let o=t.prototype[e];if("function"==typeof o)if(Array.isArray(o["^o:prop"])){let n="Async"===e.slice(-5);for(let e of o["^o:prop"])if(".referenceCount"===e)v(t,s,"^-in",o,!1,n,0);else if(".managedParent"===e)i(o,n);else{if("!managedParent"===e)throw r(37);{let i="!"===e[0];v(t,s,e.slice(1),o,i,n)}}}else if("o"===e[0]&&"n"===e[1])switch(e){case"onChangeAsync":n((e=>"Change"===e.name||e instanceof ManagedChangeEvent),o,!0);break;case"onChange":n((e=>"Change"===e.name||e instanceof ManagedChangeEvent),o);break;case"onEventAsync":n(void 0,o,!0);break;case"onEvent":n(void 0,o);break;case"onManagedParentChangeAsync":i(o,!0);break;case"onManagedParentChange":i(o);break;case"onReferenceCountChangeAsync":v(t,s,"^-in",o,!1,!0,0);break;case"onReferenceCountChange":v(t,s,"^-in",o,!1,!1,0);break;default:"Change"===e.slice(-6)?(e=("_"!==e[2]?e[2].toLowerCase():"")+e.slice(3,-6),v(t,s,e,o)):"ChangeAsync"===e.slice(-11)?(e=("_"!==e[2]?e[2].toLowerCase():"")+e.slice(3,-11),v(t,s,e,o,!1,!0)):"Async"===e.slice(-5)?(e=e.slice(2,-5),n((t=>t.name===e),o,!0)):(e=e.slice(2),n((t=>t.name===e),o,!1))}}}(e,i),n=!1,y(this,i))}))}function g(e,t){return function(n,i){let o=Object.getOwnPropertyDescriptor(n,i);if(!o||!o.get)throw r(38);o.get["-shadow"]=e,o.get["-async"]=!!t}}function f(...e){return function(t,n){let i=t[n];if("function"!=typeof i)throw TypeError();i["^o:prop"]||(i["^o:prop"]=[]);let o=i["^o:prop"];for(let t of e)o.some((e=>e==="."+t))||o.push("."+t)}}function v(e,t,n,i,r,s,a){if(s){let s=i["^o:rate"];l(t,n,!0,((t,l,c)=>{let h,u,m,g=a,f=l!==n,v=0,b=y(t,e);return(e,a,l)=>o(this,void 0,void 0,(function*(){if(c&&c(e,a,l),f&&(e=t[n]),r?a&&e instanceof ManagedObject:a?a instanceof ManagedChangeEvent:g!==e)try{if(g=e,s>=0){if(u=a,h)return;let e=++v;h=!0;let t=Date.now(),n=m+s-t;if(n>0?yield new Promise((e=>{setTimeout(e,n)})):yield p,v!==e)return;m=Date.now(),h=!1,a=u}else{if(h)return;h=a&&a.name||!0,yield p,h=!1}u=void 0,yield i.call(b,g,a,n)}catch(e){d(e)}}))}))}else l(t,n,!1,((t,o,s)=>{let l=a,c=o!==n,h=y(t,e);return(e,o,a)=>{if(s&&s(e,o,a),c&&(e=t[n]),r?o&&e instanceof ManagedObject:o?o instanceof ManagedChangeEvent:l!==e){l=e;try{i.call(h,e,o,n)}catch(e){d(e)}}}}))}function y(t,n){let i=n["^o:uid"]||(n["^o:uid"]=h++),o=t[u+i];if(o){if(!0===o)throw r(40)}else Object.defineProperty(t,u+i,{enumerable:!1,configurable:!1,writable:!0,value:!0}),o=t[u+i]=new n(t),t["^$"]===e.ManagedState.ACTIVE&&o.onActive&&o.onActive();return o}const b=Object.prototype.hasOwnProperty;var C;e.ManagedState=void 0,(C=e.ManagedState||(e.ManagedState={}))[C.DESTROYED=0]="DESTROYED",C[C.CREATED=1]="CREATED",C[C.ACTIVATING=2]="ACTIVATING",C[C.ACTIVE=3]="ACTIVE",C[C.DEACTIVATING=4]="DEACTIVATING",C[C.INACTIVE=5]="INACTIVE",C[C.DESTROYING=6]="DESTROYING";let w=[];for(let e=0;e<250;e++)w[e]={u:0,a:void 0,b:void 0,p:"",j:void 0,k:void 0,f:void 0,g:void 0};let I=16,_=16;class ManagedObject{constructor(){this.managedId=I++,this["^$"]=e.ManagedState.CREATED,Object.defineProperty(this,"^$",Object.assign(Object.assign({},Object.getOwnPropertyDescriptor(this,"^$")),{writable:!0,enumerable:!1})),this["^-in"]=0,Object.defineProperty(this,"^-in",Object.assign(Object.assign({},Object.getOwnPropertyDescriptor(this,"^-in")),{enumerable:!1})),Object.defineProperty(this,"^-out",{value:[],writable:!1,configurable:!1,enumerable:!1}),this["^-new"]()}static addObserver(e){return m(this,(()=>e)),this}static addEventHandler(e){if(this===ManagedObject)throw r(22);let t,n;return b.call(this.prototype,"^-ev")?n=this.prototype["^-ev"]:(t=Object.getPrototypeOf(this.prototype),Object.defineProperty(this.prototype,"^-ev",{enumerable:!1,configurable:!1,writable:!0})),this.prototype["^-ev"]=function(i){t&&t["^-ev"]?t["^-ev"].call(this,i):n&&n.call(this,i);try{e.call(this,i)}catch(e){d(e)}},this}"^-new"(){}static _addInitializer(e){let t=b.call(this.prototype,"^-new")&&this.prototype["^-new"];if(t)this.prototype["^-new"]=function(){t.call(this),e.call(this)};else{let t=Object.getPrototypeOf(this.prototype);this.prototype["^-new"]=function(){let n=t["^-new"];n&&n.call(this),e.call(this)}}}get managedState(){return this["^$"]}getReferenceCount(){return this["^-in"]}getManagedReferrers(){let e=Object.create(null),t=[];return this["^-out"].forEach((n=>{let i=n.a;i.managedState&&!e[i.managedId]&&t.push(i)})),t}getManagedParent(e){let t=this["^-out"].parent,n=t&&t.a;if(e&&n&&!(n instanceof e)){let t=n["^-out"].parent;if(n=t&&t.a,n&&!(n instanceof e)){let i;for(t=n["^-out"].parent,n=t&&t.a;n&&!(n instanceof e)&&((i||(i=Object.create(null)))[n.managedId]=!0,t=n["^-out"].parent,n=t&&t.a,!n||!i[n.managedId]););}}return n&&n!==this?n:void 0}emit(e,...t){if(!this["^$"]&&e!==ManagedCoreEvent.DESTROYED)throw r(26);if("string"==typeof e&&(e=new ManagedEvent(e).freeze()),"function"==typeof e&&(e=new e(...t).freeze()),!(e instanceof ManagedEvent))throw r(23);if(void 0===this._emitting)Object.defineProperty(this,"_emitting",{enumerable:!1,writable:!0,value:0});else if(this._emitting>4)throw r(24,e.name);let n;try{this._emitting=this._emitting+1,this["^-ev"]&&this["^-ev"](e),this["^-out"].forEach((t=>{t&&t.a&&t.f&&t.f.call(void 0,e,t.a,this)}))}catch(e){n=e}return this._emitting--,n&&d(n),this}emitChange(e){void 0===e?this.emit(a):this.emit(ManagedChangeEvent,e)}propagateChildEvents(...e){return c(this,!0,...e),this}activateManagedAsync(){return o(this,void 0,void 0,(function*(){return this._transitionManagedState(e.ManagedState.ACTIVE,(()=>o(this,void 0,void 0,(function*(){this["^$"]=e.ManagedState.ACTIVATING,yield this.onManagedStateActivatingAsync()}))),ManagedCoreEvent.ACTIVE,this.onManagedStateActiveAsync)}))}deactivateManagedAsync(){return o(this,void 0,void 0,(function*(){yield this._transitionManagedState(e.ManagedState.INACTIVE,(()=>o(this,void 0,void 0,(function*(){this["^$"]=e.ManagedState.DEACTIVATING,yield this.onManagedStateDeactivatingAsync()}))),ManagedCoreEvent.INACTIVE,this.onManagedStateInactiveAsync)}))}destroyManagedAsync(){return o(this,void 0,void 0,(function*(){let t,n=3;for(;(t=this["^$"])===e.ManagedState.ACTIVE||t===e.ManagedState.ACTIVATING||t===e.ManagedState.DEACTIVATING;){if(n--<=0)throw r(25);yield this.deactivateManagedAsync()}t&&(yield this._transitionManagedState(e.ManagedState.DESTROYED,(()=>o(this,void 0,void 0,(function*(){this["^$"]=e.ManagedState.DESTROYING,yield this.onManagedStateDestroyingAsync();let t=this["^-out"];delete t.parent,delete t.head,delete t.tail;let n=[];for(let e in t)t[e]&&(t[e].g&&n.push(t[e].g),ManagedObject._discardRefLink(t[e]));this["^$"]=e.ManagedState.DESTROYED,n.forEach((e=>{try{e(this)}catch(e){}}))}))),ManagedCoreEvent.DESTROYED))}))}onManagedStateActivatingAsync(){return o(this,void 0,void 0,(function*(){}))}onManagedStateActiveAsync(){return o(this,void 0,void 0,(function*(){}))}onManagedStateDeactivatingAsync(){return o(this,void 0,void 0,(function*(){}))}onManagedStateInactiveAsync(){return o(this,void 0,void 0,(function*(){}))}onManagedStateDestroyingAsync(){return o(this,void 0,void 0,(function*(){}))}_transitionManagedState(e,t,n,i){b.call(this,"_transition")||Object.defineProperty(this,"_transition",{configurable:!1,writable:!0,enumerable:!1});let s=s=>o(this,void 0,void 0,(function*(){let o,a=this["^$"];if(e!==a){if(!a)throw r(26);this._transition=s;try{yield t.call(this),this["^$"]=e,o=!0,this.emit(n),i&&i.call(this)}finally{o||(this["^$"]=a),this._transition=s.pending||void 0}}})),a=t=>{let n,i,o={state:e,p:new Promise(((e,r)=>{n=r;let a=()=>{i||e(s(o))};t.then(a,a)})),reject(){i=!0,n(r(27))}};return o};if(this._transition){if(this._transition.pending){if(this._transition.pending.state===e)return this._transition.pending.p;this._transition.pending.reject(),this._transition.pending=void 0}return this._transition.state===e?this._transition.p:(this._transition.pending=a(this._transition.p)).p}return(this._transition=a(Promise.resolve())).p}static _createRefLink(e,t,n,i,o){let r,s=t["^-out"];return w.length?(r=w.pop(),r.a=e,r.b=t,r.p=n,r.f=i,r.g=o,r.u=s.length,r.j=r.k=void 0):r={u:s.length,a:e,b:t,p:n,f:i,g:o,j:void 0,k:void 0},s.push(r),t["^-in"]++,e["^-out"][n]=r,r}static _discardRefLink(e){if(!(e&&e.u>=0&&e.a&&e.b))return!1;let t=e.a&&e.a["^-out"];t&&t[e.p]===e&&("@"===e.p[0]?(t.head===e&&(t.head=e.k),t.tail===e&&(t.tail=e.j),e.j&&e.j.k===e&&(e.j.k=e.k),e.k&&e.k.j===e&&(e.k.j=e.j),delete t[e.p]):t[e.p]=void 0);let n=e.b&&e.b["^-out"];if(n&&n[e.u]===e){if(e.b["^-in"]--,e.u>=0&&e.u===n.length-1){let e=n.length-2;for(;e>=0&&void 0===n[e];)e--;n.length=e+1}else delete n[e.u];n.parent===e&&e.b!==e.a&&(n.parent=void 0,e.b.destroyManagedAsync().catch(d))}return w.length<1e3&&(e.a=e.b=e.f=e.g=e.j=e.k=void 0,w.push(e)),!0}static _makeManagedChildRefLink(e,t){let n=e.b,i=n["^-out"];if(i[e.u]===e){let o=i.parent;if(!o||o.a!==e.a){if(i.parent=e,o){this._discardRefLink(o);try{o.g&&o.g(this)}catch(e){}}else n._makeRefManagedParent();n["^$"]&&n.emit(ManagedParentChangeEvent,e.a,t)}}}static _isManagedChildRefLink(e){return e.b["^-out"].parent===e}static _validateReferenceAssignment(e,t,n=ManagedObject,i){if(void 0!==t){if(!e["^$"])throw r(29);if(!(t instanceof n))throw r(28,i);if(!t["^$"])throw r(29)}}static createManagedReferenceProperty(e,t,n,i,o){if(!(e instanceof ManagedObject))throw r(30);let s=Object.getOwnPropertyDescriptor(e,t);if(s&&(!s.set||!s.set["^-ch"]))throw r(31);let a="P"+_++;return l(e,t,!1,((e,s,l)=>(c,d,h)=>{if(d){if(i){if(c!==i)return;c=i.get()}return void(l&&l(c,d,h))}if(i&&c!==i)throw r(32);ManagedObject._validateReferenceAssignment(e,c,o,t);let u=e["^-out"][a];if(!u||!c||u.b!==c||i){if(ManagedObject._discardRefLink(u),c){let i=ManagedObject._createRefLink(e,c,a,((e,i,o)=>{h(o,e,h),n&&i["^-ec"]&&i["^-ec"](e,t)}),(()=>{e[s]=void 0}));n&&ManagedObject._makeManagedChildRefLink(i,t)}i&&(c=i.get()),l&&l(c,d,h)}}),(function(){let e=this["^-out"][a];return i?(e||(ManagedObject._createRefLink(this,i,a),this[t]=i),i.get()):e&&e.b}))}_makeRefManagedParent(){}}class ManagedMap extends ManagedObject{constructor(){super()}propagateEvents(...e){return c(this,!1,...e),this}restrict(e){if(this.objects().some((t=>!(t instanceof e))))throw r(20);return this._managedClassRestriction=e,this}get(e){if(!this["^$"])return;let t=this["^-out"]["%"+String(e)];return t&&t.b}has(e){return!!this["^$"]&&!!this["^-out"]["%"+String(e)]}unset(e){let t=this["^-out"]["%"+String(e)],n=t&&t.b;return t&&ManagedObject._discardRefLink(t)&&this.managedState&&this.emit(ManagedObjectRemovedEvent,this,n,e),this}set(e,t){if(!this["^$"])throw r(21);let n=this["^-out"];if(e=String(e),ManagedObject._validateReferenceAssignment(this,t,this._managedClassRestriction,e),!t)return this.unset(e);let i="%"+e,o=n[i];if(o){if(t&&o.b===t)return this;ManagedObject._discardRefLink(o)}let s=ManagedObject._createRefLink(this,t,i,(e=>{this["^-en"]?this["^-en"](e,""):this["^-ec"]&&ManagedObject._isManagedChildRefLink(s)&&this["^-ec"](e,"")}),(t=>{this.managedState&&this.emit(ManagedObjectRemovedEvent,this,t,e)}));return n.parent&&!this._isWeakRef&&ManagedObject._makeManagedChildRefLink(s),this.emit(ManagedObjectAddedEvent,this,t,e),this}remove(e){let t,n,i=this["^-out"];for(let o in i)i[o]&&i[o].b===e&&ManagedObject._discardRefLink(i[o])&&(n=o.slice(1),t=!0);return t&&this.managedState&&this.emit(ManagedObjectRemovedEvent,this,e,n),this}clear(){let e,t=this["^-out"];for(let n in t)if("%"===n[0]){let i=t[n];ManagedObject._discardRefLink(i)&&(e=!0)}return e&&this.emitChange(),this}objects(){let e=[];if(!this["^$"])return e;let t=Object.create(null),n=this["^-out"];for(let i in n)if("%"===i[0]){let o=n[i]&&n[i].b;o&&!t[o.managedId]&&(t[o.managedId]=!0,e.push(o))}return e}keys(){let e=[],t=this["^-out"];if(!t)return e;for(let n in t)"%"===n[0]&&t[n]&&e.push(n.slice(1));return e}forEach(e){let t=this["^-out"];if(t)for(let n in t)if("%"===n[0]&&t[n]){let i=n.slice(1),o=t[n]&&t[n].b;o&&e(i,o)}}includes(e){return e instanceof ManagedObject&&e["^-out"].some((e=>e.a===this&&"%"===e.p[0]))}toObject(){let e=Object.create(null);if(!this["^$"])return e;let t=this["^-out"];for(let n in t)"%"===n[0]&&t[n]&&(e[n.slice(1)]=t[n].b);return e}toJSON(){return this.toObject()}weakRef(){return this._isWeakRef=!0,this}_makeRefManagedParent(){if(this._isWeakRef)return;let e=this["^-out"];for(let t in e)e[t]&&e[t].a===this&&ManagedObject._makeManagedChildRefLink(e[t])}}const S="P*ref";class ManagedReference extends ManagedObject{constructor(e){super(),e&&this.set(e)}propagateEvents(...e){return c(this,!1,...e),this}restrict(e){let t=this.get();if(t&&!(t instanceof e))throw r(34);return this._managedClassRestriction=e,this}get(){let e=this["^-out"]["P*ref"];return e&&e.b}clear(){return this.set()}set(e){ManagedObject._validateReferenceAssignment(this,e,this._managedClassRestriction);let t=this["^-out"]["P*ref"];if(t){if(e&&t.b===e)return;ManagedObject._discardRefLink(t)}if(e){let t=ManagedObject._createRefLink(this,e,S,(e=>{let t=this["^-en"]||this["^-ec"];t&&t.call(this,e,"")}),(()=>{this.managedState&&this.emit(ManagedChangeEvent)}));this["^-out"].parent&&!this._isWeakRef&&ManagedObject._makeManagedChildRefLink(t)}return this.emitChange(),this}weakRef(){return this._isWeakRef=!0,this}_makeRefManagedParent(){if(this._isWeakRef)return;let e=this["^-out"];e["P*ref"]&&ManagedObject._makeManagedChildRefLink(e["P*ref"])}toJSON(){let e=this.get();return{$ref:e?e.managedId:void 0}}}function x(e,t){ManagedObject.createManagedReferenceProperty(e,t)}function U(e,t){ManagedObject.createManagedReferenceProperty(e,t,!0)}class ServiceContainer extends ManagedObject{constructor(){super(),this.services=new ManagedMap}}function E(e){return(t,n)=>{let i=String(e).toUpperCase(),o=ServiceContainer.instance.services.get(i);o||(o=(new ManagedReference).restrict(ManagedService).propagateEvents(),ServiceContainer.instance.services.set(i,o)),ManagedObject.createManagedReferenceProperty(t,n,!1,o)}}ServiceContainer.instance=new ServiceContainer,i([U],ServiceContainer.prototype,"services",void 0);class ManagedService extends ManagedObject{static find(e){let t=String(e).toUpperCase(),n=ServiceContainer.instance.services.get(t);return n&&n.get()}static link(e,t,n){if(!n)throw r(35);E(e)(t.prototype,n)}constructor(e){super(),e&&(this.name=e)}register(){let e=String(this.name||"").toUpperCase();if(!e)throw r(36);let t=ServiceContainer.instance.services.get(e);return t?t.set(this):(t=new ManagedReference(this).restrict(ManagedService).propagateEvents(),ServiceContainer.instance.services.set(e,t)),this}}class UnhandledErrorEvent extends ManagedEvent{constructor(e){super("ERROR"),this.error=e}}class UnhandledErrorEmitter extends ManagedObject{constructor(){if(super(),UnhandledErrorEmitter.instance)throw Error()}static emitError(e){console.error?console.error(e):console.log&&console.log(e),UnhandledErrorEmitter.instance.emit(UnhandledErrorEvent,e)}}var O;function M(e){UnhandledErrorEmitter.emitError(e)}function R(e,t){"{"===e[0]&&(e=e.slice(1,-1));let n=e.match(/^([-0+ ]+)?(\d+)?(\.\d+)?([%ndiufFeEgGxXsc])$/);if(!n){let n=e.split(":"),i=j[n.shift()];return i?i(t,...n):(M(r(11,e)),"???")}{let e,i,o,[,r,s,a,l]=n;r&&(r.indexOf("-")>=0?e=!0:r.indexOf("0")>=0&&(o="0"),r.indexOf("+")>=0?i="+":r.indexOf(" ")>=0&&(i=" "));let c,d=+s||0,h=a?+a.slice(1)||0:void 0;switch(l){case"%":return"%";case"d":case"i":case"u":return A(String(Math.round(Math.abs(+t))||0),t<0,d,e,i,o);case"n":case"N":let n=Math.abs(+t).toFixed(null!=h?h:6);return n.length&&(n=n.replace(/\.?0+$/,"")),A(n,t<0,d,e,i,o);case"f":case"F":return A(Math.abs(+t).toFixed(null!=h?h:6),t<0,d,e,i,o);case"e":case"E":return c=A(Math.abs(+t).toExponential(null!=h?h:6),t<0,d,e,i,o),"E"===l?c.toUpperCase():c;case"g":case"G":let r=Math.abs(+t).toExponential(null!=h?h:6).replace(/\.?0+e/,"e"),s=+r.split("e")[1]||0;return s>=-4&&s<=(null!=h?h:6)&&(r=Math.abs(+t).toFixed(null!=h?h:6),r.length&&(r=r.replace(/\.?0+$/,""))),c=A(r,t<0,d,e,i,o),"G"===l?c.toUpperCase():c;case"x":case"X":return c=A(Math.abs(+t||0).toString(16),t<0,d,e,i,o),"X"===l?c.toUpperCase():c;case"c":t=null==t?"":String.fromCharCode(+t);case"s":return c=String(null!=t?t:""),d>0&&(c=e?T(c,d):k(c,d," ")),h>0&&(c=c.slice(0,h)),c}}}function A(e,t,n,i,o,r){let s=t?"-":o||"";if(i)return T(s+e,n);if(r&&/^[\da-f]/.test(e)||(r=" "),s)return s+k(e,n-1,r);let a=I18nService.get();return a&&"."!==a.decimalSeparator&&(e=e.replace(".",a.decimalSeparator)),k(e,n,r||" ")}function T(e,t){if(e.length>=t)return e;for(let n=e.length;n<t;n++)e+=" ";return e}function k(e,t,n){if(e.length>=t)return e;for(let i=e.length;i<t;i++)e=n+e;return e}UnhandledErrorEmitter.instance=new UnhandledErrorEmitter,O=UnhandledErrorEmitter.emitError,d=O;const j={_:()=>{},"!":e=>!e,"not?":e=>!e,"?":e=>!!e,"!!":e=>!!e,n:e=>+e,num:e=>+e,then:(e,t,n)=>e&&t||n,else:(e,t)=>e||t,or:(e,t)=>e||t,uc:function(e){return null==e?e:String(e).toUpperCase()},lc:function(e){return null==e?e:String(e).toLowerCase()},uniq:function(e){if(!Array.isArray(e)){if(!e||!e.toArray)return e;if(e=e.toArray(),!Array.isArray(e))return e}let t=[],n=Object.create(null);return e.filter((e=>null!=e&&("string"==typeof e?!n[e]&&(n[e]=!0):!(t.indexOf(e)>=0||(t.push(e),0)))))},pluck:function(e,t){if(!Array.isArray(e)){if(!e||!e.toArray)return e;if(e=e.toArray(),!Array.isArray(e))return e}return e.map((e=>e&&e[t]))},local:function(){let e=I18nService.get();return e?e.format.apply(e,arguments):"???"}},P=new ManagedReference;let B=0;class I18nService extends ManagedService{constructor(){super(...arguments),this.name="Core.I18n",this.decimalSeparator="."}static get(){return P.get()}register(){return super.register(),P.set(this),B++,this}loadTexts(e){this._loadedTexts||(this._loadedTexts={});for(let t of e)t[1]&&(this._loadedTexts[t[0]]=t[1]);B++}getText(e){var t;return(null===(t=this._loadedTexts)||void 0===t?void 0:t[e])?this._loadedTexts[e]:e}getPlural(e,t){return t[1==e?0:1]||""}}class I18nString{constructor(e,t){this.format=e,t&&this.update(t)}toString(){return""}update(e){let t,n=this.format,i=B;return this.toString=()=>{if(B!==i&&(t=void 0,this.text=void 0),void 0!==t)return t;let o;if(void 0===this.text&&(this.text=((o=P.get())?o.getText(String(n)):String(n)).replace(/\*\*\*\{.*\}\*\*\*/g,"")),!e.length)return t=this.text;let s=this.text.replace(/\#(?:(\d+)\$)?\{([^}]*)\}/g,(o=o||P.get())?(t,n,i)=>o.getPlural(+e[n?n-1:0]||0,i.split("/")):(t,n,i)=>i.split("/")[1==e[n?n-1:0]?0:1]);return t=function(e,t){let n=0;return e.replace(/\%(?:(\d+)\$)?(\{[^\}]*\}|[-+*.0-9 ]*[%a-zA-Z])/g,((e,i,o)=>{var s;if("%"===o)return"%";if("s"===o)return String(null!==(s=i?t[i-1]:t[n++])&&void 0!==s?s:"");let a=R(o=o.replace(/\*/g,(()=>String(t[n++]))),i?t[i-1]:t[n++]);if("object"==typeof a){if(a.toString===Object.prototype.toString)return M(r(10)),"???";if(a.toString===Array.prototype.toString&&a.map===Array.prototype.map)return a.map((e=>null!=e&&String(e)||"")).join(", ")}return String(null!=a?a:"")}))}(s,e)},this}}function D(e,...t){return e instanceof I18nString?t.length?new I18nString(e.format,t):e:new I18nString(e,t)}class AppException extends Error{constructor(...e){super()}static group(e){let t={};for(let n in e)t[n]=this.type(n,e[n]);return t}static type(e,t){var n;let i=D(t);return(n=class AppExceptionType extends AppException{constructor(...t){super(),this.code=e,this.message=i.update([t]).toString()}}).code=e,n}}if("function"!=typeof Symbol){if("object"!=typeof window)throw r(14);window.Symbol={iterator:"Symbol.iterator_shim_"+Math.random()}}class ManagedList extends ManagedObject{constructor(...e){super(),this["^count"]=0,this["^count"]=0,Object.defineProperty(this,"_managedCount",Object.assign(Object.assign({},Object.getOwnPropertyDescriptor(this,"_managedCount")),{enumerable:!1}));for(let t of e)this.insert(t)}propagateEvents(...e){return c(this,!1,...e),this}restrict(e){if(this.toArray().some((t=>!(t instanceof e))))throw r(15);return this._managedClassRestriction=e,this}get count(){return this["^-out"].head?this["^count"]:0}add(...e){for(let t of e)this.insert(t);return this}insert(e,t){if(!this["^$"])throw r(16);let n=this["^-out"];if(ManagedObject._validateReferenceAssignment(this,e,this._managedClassRestriction),void 0===e)throw ReferenceError();if(this.includes(e))throw r(17);let i=t&&n["@"+t.managedId];if(t&&(!i||i.b!==t))throw r(18);let o="@"+e.managedId,s=ManagedObject._createRefLink(this,e,o,(e=>{this["^-en"]?this["^-en"](e,""):this["^-ec"]&&ManagedObject._isManagedChildRefLink(s)&&this["^-ec"](e,"")}),(e=>{this["^count"]--,this.managedState&&this.emit(ManagedObjectRemovedEvent,this,e)}));return i?(n.head===i&&(n.head=s),(s.j=i.j)&&(s.j.k=s),s.k=i,i.j=s):n.tail?(n.tail.k=s,s.j=n.tail,s.k=void 0,n.tail=s):n.head=n.tail=s,this["^count"]++,n.parent&&!this._isWeakRef&&ManagedObject._makeManagedChildRefLink(s),this.emit(ManagedObjectAddedEvent,this,e),this}remove(e){if(!(e instanceof ManagedObject))throw TypeError();let t=e instanceof ManagedObject&&this["^-out"]["@"+e.managedId];return t&&t.b===e&&ManagedObject._discardRefLink(t)&&(this["^count"]--,this.managedState&&this.emit(ManagedObjectRemovedEvent,this,e)),this}splice(e,t,...n){if(void 0!==e&&!(e instanceof ManagedObject))throw TypeError();let i,o=[];for("number"==typeof t&&(i=t);e&&e!==t&&!(i--<1);){let t=e instanceof ManagedObject&&this["^-out"]["@"+e.managedId],n=t&&t.k&&t.k.b;t&&t.b===e&&(o.push(e),ManagedObject._discardRefLink(t)&&(this["^count"]--,this.emit(ManagedObjectRemovedEvent,this,e))),e=n}for(let t of n)this.insert(t,e);return o}replace(e){let t,n=this["^-out"],i=[],o=(e,t)=>i.unshift((()=>this.insert(e,t))),r=[],s=e=>r.push((()=>this.remove(e))),a=[],l=(e,i)=>a.unshift((()=>{let o=n["@"+e.managedId];if(!o)return;let r=i&&n["@"+i.managedId];o!==r&&o.k!==r&&(t=!0,n.head===o&&(n.head=o.k),n.tail===o&&(n.tail=o.j),o.j&&(o.j.k=o.k),o.k&&(o.k.j=o.j),o.k=r,r?(o.j=r.j,r.j&&(r.j.k=o),r.j=o):(o.j=n.tail,o.j&&(o.j.k=o)),o.j||(n.head=o),o.k||(n.tail=o))})),c=Object.create(null),d=[];for(let t of e)if(void 0!==t)if(t instanceof ManagedObject&&(c[t.managedId]=!0),this.includes(t))for(d.unshift(l.bind(this,t));d.length>1;)d.pop()(t);else d.push(o.bind(this,t));for(;d.length;)d.pop()(void 0);let h=this["^-out"].head;for(;h;)c[h.b.managedId]||s(h.b),h=h.k;for(let e of r)e();for(let e of a)e();t&&this.emit(ManagedListChangeEvent,void 0,this);for(let e of i)e();return this}clear(){let e=this.toArray();for(let t of e)this.remove(t);return this}includes(e){let t=e&&e.managedId,n=t&&this["^-out"]["@"+t];return!!n&&n.b===e}first(){let e=this["^-out"].head;return e&&e.b}last(){let e=this["^-out"].tail;return e&&e.b}get(e){if(this["^$"]&&e>=0){let t=this["^-out"].head;for(let n=e;t&&n>0;n--)t=t.k;if(t&&t.b)return t.b}throw r(19,e)}find(e){let t=this["^-out"]["@"+e];if(!t||t.b.managedId!==e)throw r(18);return t.b}take(e,t){return this._take(e,t)}takeLast(e,t){return this._take(e,t,!0)}_take(e,t,n){let i,o=[];if(!this["^$"])return o;for(i=t&&this.includes(t)?this["^-out"]["@"+t.managedId]:this["^-out"][n?"tail":"head"];i&&e-- >0;)o[n?"unshift":"push"](i.b),i=n?i.j:i.k;return o}indexOf(e){if(!this["^$"])return-1;let t=this["^-out"].head;for(let n=0;t;n++,t=t.k)if(t.b===e)return n;return-1}toArray(){if(!this["^$"])return[];let e=new Array(this.count),t=0,n=this["^-out"].head;for(;n;)e[t++]=n.b,n=n.k;return e}toJSON(){return this.toArray()}some(e){for(let t of this)if(e(t))return!0;return!1}every(e){for(let t of this)if(!e(t))return!1;return!0}forEach(e){for(let t of this)e(t)}map(e){let t=[];for(let n of this)t.push(e(n));return t}pluck(e){if(!this["^$"])return[];let t=new Array(this.count),n=0,i=this["^-out"].head;for(;i;)t[n++]=i.b[e],i=i.k;return t}[Symbol.iterator](){let e=this["^-out"],t=this["^-out"].head,n=t?t.b:0;return{next(){let i=n;return i&&e[t.p]===t?(t=t.k,n=t?t.b:0,{value:i,done:!1}):{done:!0}}}}weakRef(){return this._isWeakRef=!0,this}_makeRefManagedParent(){if(this._isWeakRef)return;let e=this["^-out"];if(e.head){let t=[];for(let n=e.head;n;n=n.k)t.push(n);for(let n of t)e[n.p]===n&&ManagedObject._makeManagedChildRefLink(n)}}}i([g("^count")],ManagedList.prototype,"count",null);let L=16;class Binding{constructor(e,t){let n;this.id="^^bind:"+L++;let i=void 0!==e?String(e):void 0;if(i&&(this._source=e),void 0!==i){let e=String(i).split("|");for(n=e.shift().split("."),i=n.shift();"!"===i[0];)i=i.slice(1),this.addFilter("!");n.length||(n=void 0);for(let t of e)this.addFilter(t)}this.propertyName=i;let o=this;this.Reader=class{constructor(e){this.boundParent=e}getValue(e){let r=arguments.length>0?e:void 0!==i?this.boundParent[i]:void 0;if(n)for(let e=0;e<n.length&&null!=r;e++){let t=n[e];r="object"!=typeof r||t in r||"function"!=typeof r.get?r[t]:r.get(t)}return o._filter&&(r=o._filter(r,this.boundParent)),void 0===r&&void 0!==t?t:r}}}static isBinding(e){return!!(e&&e.isComponentBinding&&e instanceof Binding)}isComponentBinding(){return!0}get bindings(){return this._bindings}addFilter(e){e=String(e).trim();let t=this._filter;return this._filter=(n,i)=>(t&&(n=t(n,i)),R(e,n)),this}then(e){let t=this._filter;return this._filter=(n,i)=>(t&&(n=t(n,i)),n?e:n),this}else(e){let t=this._filter;return this._filter=(n,i)=>(t&&(n=t(n,i)),n||e),this}match(...e){let t=this._filter;return this._filter=(n,i)=>(t&&(n=t(n,i)),e.some((e=>e===n))),this}nonMatch(...e){let t=this._filter;return this._filter=(n,i)=>(t&&(n=t(n,i)),!e.some((e=>e===n))),this}and(e,t){let n=e instanceof Binding?e:new Binding(e,t);n.parent=this,this._source&&(this._source+=" and "+String(e)),this._bindings||(this._bindings=[]),this._bindings.push(n);let i=this._filter;return this._filter=(e,t)=>{i&&(e=i(e,t));let o=t.getBoundBinding(n);if(!o)throw r(7,this.toString());return e&&o.value},this}or(e,t){let n=e instanceof Binding?e:new Binding(e,t);n.parent=this,this._source&&(this._source+=" or "+String(e)),this._bindings||(this._bindings=[]),this._bindings.push(n);let i=this._filter;return this._filter=(e,t)=>{i&&(e=i(e,t));let o=t.getBoundBinding(n);if(!o)throw r(7,this.toString());return e||o.value},this}debuggerLog(){let e=this._filter;return this._filter=(t,n)=>(e&&(t=e(t,n)),console.log("--- ",this.toString(),t),t),this}toString(){return"bind("+(this._source||"")+")"}}class StringFormatBinding extends Binding{constructor(e,...t){super(void 0),this._format=e,t.length||(e=String(e).replace(/\$\{[^}]+\}/g,(e=>(t.push(e.slice(2,-1)),"%s"))));let n=this._bindings=t.map((e=>{let t=e instanceof Binding?e:new Binding(e);return t.parent=this,t}));this.Reader=class extends this.Reader{constructor(t){super(t),this.i18nString=new I18nString(e)}getValue(){let e=n.map(((e,n)=>{let i=this.boundParent.getBoundBinding(e);if(!i)throw r(7,t[n]);return i.value})),i=this.i18nString.update(e).toString();return super.getValue(i)}}}toString(){return"bindf("+JSON.stringify(this._format)+")"}}function F(e,t){return new Binding(e,t)}!function(e){e.Bound=class Bound extends ManagedList{constructor(e,t){if(super(),this.binding=e,e.parent){let n=t.getBoundBinding(e.parent);if(!n)throw r(8);this.parent=n}this.propertyName=e.propertyName,this._reader=new e.Reader(t)}hasValue(){return!!this._updatedValue}get value(){return this._updatedValue?this._lastValue:this._reader.getValue()}updateComponents(e){if(!this.count&&!this.parent)return void(this._updatedValue=!1);let t=this._reader.getValue(...arguments);if(!this._updatedValue||this._lastValue!==t){this._updatedValue=!0;let e=this._lastValue;if(this._lastValue=t,this.parent)return void this.parent.updateComponents();let n=this.binding.id;this.forEach((i=>{try{if("function"!=typeof i[n])throw r(9);i[n](t,e)}catch(e){M(e)}}))}}}}(Binding||(Binding={}));class ComponentEvent extends ManagedEvent{constructor(e,t,n){super(e),this.source=t,this.inner=n}}class ActionEvent extends ComponentEvent{}class Component extends ManagedObject{constructor(){super()}static with(...e){let t,n=this;class PresetComponent extends n{constructor(...e){super(...e),t.call(this)}isPresetComponent(){return!0}}let i=e[0],o=Object.getPrototypeOf(i);return t="object"!=typeof i||o&&o!==Object.prototype?PresetComponent.preset(Object.create(null),...e):PresetComponent.preset(...e),PresetComponent}static preset(e,...t){let n,i;for(let o in e){let r=e[o];Binding.isBinding(r)?(this.presetBinding(o,r),delete e[o]):r&&"o"===o[0]&&"n"===o[1]&&(o[2]<"a"||o[2]>"z")?("string"==typeof r&&(r[0]<"a"||r[0]>"z")?("+"===r[0]&&(r=r.slice(1)),n||(n=Object.create(null)),n[o.slice(2)]=r):(i||(i=Object.create(null)),i[o.slice(2)]="function"==typeof r?r:V(String(r))),delete e[o]):"function"==typeof r&&r.prototype instanceof Component&&t.push(r)}return t.length&&this.presetBindingsFrom(...t),n&&this.addEventHandler((function(e){let t=n[e.name];t&&this.emitAction(t,e)})),i&&this.addEventHandler((function(e){let t=i[e.name];t&&t.call(this,e)})),function(){for(let t in e){let n=e[t];void 0!==n&&H(this,t,n)}}}static presetBinding(e,t,n){this.prototype.hasOwnProperty("^+bnd")||(this.prototype["^+bnd"]=Object.create(this.prototype["^+bnd"])),this.prototype["^+bnd"][e]=t,n||(n=function(t,n){H(this,e,t,n)}),this.prototype[t.id]=n}static presetBindingsFrom(...e){if(!this.prototype.hasOwnProperty("^+bndI")){let e=this.prototype["^+bndI"];this.prototype["^+bndI"]=e?e.slice():[]}for(const t of e)if(t){if(!(t.prototype&&t.prototype instanceof Component))throw TypeError();this.prototype["^+bndI"].push(t)}}static presetBoundComponent(e,...t){this.prototype.hasOwnProperty("^+bndC")||(this.prototype["^+bndC"]=Object.assign({},this.prototype["^+bndC"]));let n=new Component.BoundComposition(this,...t);return this.prototype["^+bndC"][e]=n,n}isPresetComponent(){return!1}delegateEvent(e,t){let n=this[(i=e.name,"on"+(i[0]<"a"||i[0]>"z"?i:String.fromCharCode(i.charCodeAt(0)-32)+i.slice(1)))];var i;let o="function"==typeof n&&n.call(this,e,t);return!0===o||(o&&o.then&&o.catch&&o.catch((e=>d(e))),e instanceof ActionEvent?(this.emit(e),!0):void 0)}getParentComponent(e){return this.getManagedParent(e||Component)}getBoundParentComponent(e){let t=this["^+bndO"];if(!e)return t&&t.boundParent;let n=t&&t.boundParent;for(;n&&!(n instanceof e);)n=n.getBoundParentComponent();return n}emitAction(e,t,n){let i=new ActionEvent(e,this,t);i.context=n,this.emit(i.freeze())}propagateComponentEvent(e,t){this.managedState&&this.emit(ComponentEvent,e,this,t)}getBoundBinding(e){return this["^+bndO"]&&this["^+bndO"].getCompositeBound(e)}}function V(e){if("()"===e.slice(-2)){let t=e.slice(0,-2);return function(e){let n=this.getBoundParentComponent();for(;n;){let i=n&&n[t];if("function"==typeof i)return i.call(n,e);n=n.getBoundParentComponent()}throw r(12,t)}}throw r(13,e)}Component.prototype["^+bnd"]=Object.create(null),Component.prototype["^+bndI"]=[],Component.prototype["^+bndC"]=Object.create(null),function(e){e.BoundComposition=class BoundComposition{constructor(e,...t){this.Composite=e,this._bindings=this._getAllBindings(...t),m(e,(()=>this._createObserver()))}getBindings(){return this._bindings.slice()}limitBindings(...e){let t=[];this._unbound||(this._unbound=[]);for(let n of this._bindings)e.some((e=>n.propertyName===e))||n.bindings&&n.bindings.some((t=>e.some((e=>t.propertyName===e))))?t.push(n):this._unbound.push(n);this._bindings=t}_createObserver(){let e=this._bindings.filter((e=>void 0!==e.propertyName)).map((e=>e.propertyName));if(e.length){class PropertyChangeObserver{constructor(e){this.c=e}updatePropertyAsync(e,t,n){let i=this.c["^+bndO"];i&&i.updateCompositeBound(n,e)}}return i([f(...e)],PropertyChangeObserver.prototype,"updatePropertyAsync",null),PropertyChangeObserver}}_getAllBindings(...e){let t=[],n=e=>{t.push(e),e.bindings&&e.bindings.forEach((e=>n(e)))},i=e=>{if(!e)return;let t=e.prototype["^+bnd"];for(let e in t)n(t[e]);let o=e.prototype["^+bndI"];for(let e of o)i(e);let r=e.prototype["^+bndC"];for(let e in r){let t=r[e]._unbound;if(t)for(let e in t)n(t[e])}};return e.forEach(i),t}};class ComponentObserver{constructor(e){this.component=e,this._childObservers=Object.create(null),this._nChildren=0,Object.defineProperty(e,"^+bndO",{enumerable:!1,writable:!1,value:this})}getCompositeBound(e){return this._compositeBound&&this._compositeBound.get(e.id)||this.boundParent&&this.boundParent["^+bndO"]&&this.boundParent["^+bndO"].getCompositeBound(e)}onEvent(e){if(e===ManagedCoreEvent.DESTROYED)this._parentObserver&&(this._parentObserver._removeChildObserver(this),this._unbind(),this.boundParent=void 0);else if(e instanceof ManagedParentChangeEvent){let t=this.component.getParentComponent(),n=t&&t["^+bndO"];if(n===this._parentObserver)return;if(this._parentObserver&&(this._parentObserver._removeChildObserver(this),this._unbind(),this.boundParent=void 0),this._parentObserver=n,n){if(n._addChildObserver(this),e.parent===t&&e.propertyName&&t["^+bndC"][e.propertyName]){let i=t["^+bndC"][e.propertyName];this.boundParent=t,n._addCompositeBound(i.getBindings())}else this.boundParent=n.boundParent;this._bind()}for(let e in this._childObservers)this._childObservers[e]._updateParent(this,!0)}}updateCompositeBound(e,t){if(this._compositeBound)return e?arguments.length<2?this._compositeBound.forEach(((t,n)=>{n.propertyName===e&&n.updateComponents()})):this._compositeBound.forEach(((n,i)=>{i.propertyName===e&&i.updateComponents(t)})):this._compositeBound.forEach(((e,t)=>{t.updateComponents()})),this}_addChildObserver(e){let t=e.component.managedId;this._childObservers[t]||(this._childObservers[t]=e,this._nChildren=(this._nChildren||0)+1)}_removeChildObserver(e){let t=e.component.managedId;this._childObservers[t]&&(delete this._childObservers[t],!--this._nChildren&&this._compositeBound&&this._compositeBound.clear())}_updateParent(e,t){t&&e.component===this.boundParent&&(t=!1),t&&(this._unbind(),this.boundParent=e.boundParent),this._bind();for(let e in this._childObservers)this._childObservers[e]._updateParent(this,t)}_unbind(){if(this._ownBound){for(let e in this._ownBound)this._ownBound[e].remove(this.component);this._ownBound=void 0}}_bind(){var e,t;if(!this.boundParent)return;let n=this.component,i=this.boundParent["^+bndO"],o=n["^+bnd"],r=this._ownBound||(this._ownBound=Object.create(null));for(let e in o)if(!r[e]){let t=o[e],s=i.getCompositeBound(t);s&&!s.includes(n)&&(r[e]=s.add(n))}for(let i in r){let o=r[i];try{null===(t=(e=n)[o.binding.id])||void 0===t||t.call(e,o.value)}catch(e){d(e)}}}_addCompositeBound(e){this._compositeBound||(this._compositeBound=new ManagedMap);for(let t of e)this._compositeBound.has(t.id)||this._compositeBound.set(t.id,new Binding.Bound(t,this.component))}}e.ComponentObserver=ComponentObserver,e.addObserver(ComponentObserver)}(Component||(Component={}));class ManagedValueObject extends ManagedObject{constructor(e){super(),this.value=e}valueOf(){return this.value}}function N(e,t){let n;function i(e,t){if(!(e.constructor.prototype instanceof Component))throw TypeError();ManagedObject.createManagedReferenceProperty(e,t,!0,void 0,n||Component),e.constructor.presetBoundComponent(t,n)}if(!t)return e&&(n=e),i;i(e,t)}function z(e,t){l(e,t,!1,((e,n,i)=>{let o;return(n,r,s)=>{if(i&&i(n,r,s),r){if(o===r||!e["^$"])return;try{e.delegateEvent(o=r,t),o=void 0}catch(e){d(e)}}}}))}function H(e,t,n,i){let o=e[t];if(o&&o instanceof ManagedList){if(Array.isArray(n))return void o.replace(n.map((e=>e instanceof ManagedObject?e:new ManagedValueObject(e))));if(void 0===n&&i!==o)return void o.clear()}e[t]=n}class ManagedRecord extends Component{static create(e){let t=new this;if(e)for(let n in e)t[n]=e[n];return t}serialize(){let e=Object.create(null);const t=(e,n)=>{if(null==n||"string"==typeof n||"number"==typeof n||"boolean"==typeof n)return n;if(Array.isArray(n))return n.map(((n,i)=>t(e+"."+i,n)));if(!(n instanceof ManagedObject))throw r(33,e);if(n instanceof ManagedRecord&&n.getParentRecord()===this)return n.serialize();if(n instanceof ManagedReference)return t(e,n.get());if(n instanceof ManagedList)return n.map((n=>t(e,n)));if(n instanceof ManagedMap){let i=Object.create(null);return n.forEach(((n,o)=>{i[n]=t(e+"#"+n,o)})),i}};for(let n in this){if(!this.hasOwnProperty(n)||"_"===n[0]||"managedId"===n)continue;let i=t(n,this[n]);void 0!==i&&(e[n]=i)}return e}getParentRecord(e){return this.getManagedParent(e||ManagedRecord)}getNextSibling(){let e=this.getManagedParent();if(e instanceof ManagedList){let t=e.take(2,this)[1];if(t instanceof ManagedRecord)return t}}getPreviousSibling(){let e=this.getManagedParent();if(e instanceof ManagedList){let t=e.takeLast(2,this);if(t.length>1&&t[0]instanceof ManagedRecord)return t[0]}}getReferrerRecords(e){let t=Object.create(null),n=[],i=e||ManagedRecord;const o=e=>{e["^-out"].forEach((e=>{let r=e.a;r.managedState&&!t[r.managedId]&&(t[r.managedId]=!0,r instanceof i?n.push(r):(r instanceof ManagedList||r instanceof ManagedMap||r instanceof ManagedReference)&&o(r))}))};return o(this),n}}let W=1;const $=Object.create(null),K={};class InheritedStyleObject{constructor(e,t,n,i){this._inherit=n&&t?t.map((e=>e[n])).filter((e=>!!e)):[],n&&e&&e[n]&&this._inherit.unshift(e[n]),this._style=i}getStyle(){return this._style}_value(e){let t;for(let n=this._inherit.length-1;n>=0&&(t=this._inherit[n][e],void 0===t);n--);return t}}class InheritedDimensions extends InheritedStyleObject{static create(e,t,n){let i=new this(e,t,"dimensions",n);return Object.defineProperties(i,{width:{enumerable:!0,get:i._value.bind(i,"width")},height:{enumerable:!0,get:i._value.bind(i,"height")},minWidth:{enumerable:!0,get:i._value.bind(i,"minWidth")},maxWidth:{enumerable:!0,get:i._value.bind(i,"maxWidth")},minHeight:{enumerable:!0,get:i._value.bind(i,"minHeight")},maxHeight:{enumerable:!0,get:i._value.bind(i,"maxHeight")},grow:{enumerable:!0,get:i._value.bind(i,"grow")},shrink:{enumerable:!0,get:i._value.bind(i,"shrink")}}),i}}class InheritedPosition extends InheritedStyleObject{static create(e,t,n){let i=new this(e,t,"position",n);return Object.defineProperties(i,{gravity:{enumerable:!0,get:i._value.bind(i,"gravity")},top:{enumerable:!0,get:i._value.bind(i,"top")},bottom:{enumerable:!0,get:i._value.bind(i,"bottom")},left:{enumerable:!0,get:i._value.bind(i,"left")},right:{enumerable:!0,get:i._value.bind(i,"right")},start:{enumerable:!0,get:i._value.bind(i,"start")},end:{enumerable:!0,get:i._value.bind(i,"end")}}),i}}class InheritedTextStyle extends InheritedStyleObject{static create(e,t,n){let i=new this(e,t,"textStyle",n);return Object.defineProperties(i,{direction:{enumerable:!0,get:i._value.bind(i,"direction")},align:{enumerable:!0,get:i._value.bind(i,"align")},color:{enumerable:!0,get:i._value.bind(i,"color")},fontFamily:{enumerable:!0,get:i._value.bind(i,"fontFamily")},fontSize:{enumerable:!0,get:i._value.bind(i,"fontSize")},fontWeight:{enumerable:!0,get:i._value.bind(i,"fontWeight")},letterSpacing:{enumerable:!0,get:i._value.bind(i,"letterSpacing")},lineHeight:{enumerable:!0,get:i._value.bind(i,"lineHeight")},lineBreakMode:{enumerable:!0,get:i._value.bind(i,"lineBreakMode")},bold:{enumerable:!0,get:i._value.bind(i,"bold")},italic:{enumerable:!0,get:i._value.bind(i,"italic")},uppercase:{enumerable:!0,get:i._value.bind(i,"uppercase")},smallCaps:{enumerable:!0,get:i._value.bind(i,"smallCaps")},underline:{enumerable:!0,get:i._value.bind(i,"underline")},strikeThrough:{enumerable:!0,get:i._value.bind(i,"strikeThrough")}}),i}}class InheritedDecoration extends InheritedStyleObject{static create(e,t,n){let i=new this(e,t,"decoration",n);return Object.defineProperties(i,{background:{enumerable:!0,get:i._value.bind(i,"background")},textColor:{enumerable:!0,get:i._value.bind(i,"textColor")},borderColor:{enumerable:!0,get:i._value.bind(i,"borderColor")},borderStyle:{enumerable:!0,get:i._value.bind(i,"borderStyle")},borderThickness:{enumerable:!0,get:i._value.bind(i,"borderThickness")},borderRadius:{enumerable:!0,get:i._value.bind(i,"borderRadius")},padding:{enumerable:!0,get:i._value.bind(i,"padding")},dropShadow:{enumerable:!0,get:i._value.bind(i,"dropShadow")},opacity:{enumerable:!0,get:i._value.bind(i,"opacity")},css:{enumerable:!0,get:function(){let e=Object.create(null);for(let t=0;t<this._inherit.length;t++){let n=this._inherit[t].css;if(n)for(let t in n)e[t]=n[t]}return e}},cssClassNames:{enumerable:!0,get:function(){let e=Object.create(null);for(let t=this._inherit.length-1;t>=0;t--){let n=this._inherit[t].cssClassNames;if(n)if("string"==typeof n)e[n]=!0;else for(let t of n)e[t]=!0}return Object.keys(e)}}}),i}}class InheritedContainerLayout extends InheritedStyleObject{static create(e,t,n){let i=new this(e,t,"containerLayout",n);return Object.defineProperties(i,{axis:{enumerable:!0,get:i._value.bind(i,"axis")},distribution:{enumerable:!0,get:i._value.bind(i,"distribution")},gravity:{enumerable:!0,get:i._value.bind(i,"gravity")},wrapContent:{enumerable:!0,get:i._value.bind(i,"wrapContent")},clip:{enumerable:!0,get:i._value.bind(i,"clip")},separator:{enumerable:!0,get:i._value.bind(i,"separator")}}),i}}let q=Object.freeze(new InheritedStyleObject);class UIStyle{constructor(e="",t,...n){if(this.name=e,e?(e=e.replace(/[^\w\d_\-]/g,""),this.id="S_"+(K[e]?e+"--"+W++:K[e]=e)):this.id="S__"+W++,this.ids=t?[...t.ids,this.id]:[this.id],this.conditionalStyles=t?Object.assign({},t.conditionalStyles):Object.create(null),t||n.length){this.inherited=t&&[...t.inherited,t]||[];let e=t&&t.getStyles();this._styles=Object.freeze({dimensions:InheritedDimensions.create(void 0,n,this),position:InheritedPosition.create(void 0,n,this),textStyle:InheritedTextStyle.create(void 0,n,this),decoration:InheritedDecoration.create(void 0,n,this),containerLayout:InheritedContainerLayout.create(void 0,n,this)}),this._combined=Object.freeze({dimensions:InheritedDimensions.create(e,n,this),position:InheritedPosition.create(e,n,this),textStyle:InheritedTextStyle.create(e,n,this),decoration:InheritedDecoration.create(e,n,this),containerLayout:InheritedContainerLayout.create(e,n,this)})}else this.inherited=[],this._styles=Object.freeze(Object.create(null)),this._combined=Object.freeze({dimensions:q,position:q,textStyle:q,decoration:q,containerLayout:q})}static create(e,t=e){return"string"!=typeof e&&(e="UIStyle_"+W++),new UIStyle(e,void 0,t||Object.create(null))}static group(...e){let t=Object.create(null);for(let n of e)for(let e in n){let i=n[e];t[e]=e in t?t[e].extend(i instanceof UIStyle?i.getStyles():i):i instanceof UIStyle?i:UIStyle.create(e,i)}return t}static isStyleOverride(e,t){return e&&(!(e instanceof InheritedStyleObject)||t&&e.getStyle()!==t)}mixin(...e){let t=this;for(let n of e){if(!n)continue;let e=t.id+"+"+n.id;if($[e])t=$[e];else{t=new UIStyle(t.name+"--"+n.name,t,n._combined);for(let e in n.conditionalStyles)n.conditionalStyles[e]&&(t.conditionalStyles[e]=n.conditionalStyles[e]);$[e]=t}}return t}extend(e,t){return new UIStyle(t||this.name,this,e)}addState(e,t){return this.conditionalStyles[e]?this.conditionalStyles[e]=this.conditionalStyles[e].extend(t):this.conditionalStyles[e]=UIStyle.create(this.name+":"+e,t),this}getStyles(){return this._combined}getOwnStyles(){return this._styles}}class ConfirmationDialogBuilder{}class UIMenuBuilder{}class UIColor{constructor(e){e&&(this._f=()=>{let t=String(UITheme.current&&UITheme.current.colors[e]||e);return"@"===t[0]?UITheme.replaceColor(t):t})}toString(){return this._f?this._f():"transparent"}text(){let e=new UIColor;return e._f=()=>UITheme.getTextColor(String(this)),e}alpha(e){let t=new UIColor;return t._f=()=>UITheme.mixColors(String(this),"rgba(,,,0)",1-e),t}lum(e,t){let n=new UIColor;return n._f=()=>{let n=String(this);return t&&!UITheme.isBrightColor(n)&&(e=-e),UITheme.mixColors(n,e>0?"#fff":"#000",Math.abs(e))},n}}UIColor.Black=new UIColor("black"),UIColor.DarkerGray=new UIColor("darkerGray"),UIColor.DarkGray=new UIColor("darkGray"),UIColor.Gray=new UIColor("gray"),UIColor.LightGray=new UIColor("lightGray"),UIColor.White=new UIColor("white"),UIColor.Slate=new UIColor("slate"),UIColor.Red=new UIColor("red"),UIColor.Orange=new UIColor("orange"),UIColor.Yellow=new UIColor("yellow"),UIColor.Lime=new UIColor("lime"),UIColor.Green=new UIColor("green"),UIColor.Turquoise=new UIColor("turquoise"),UIColor.Cyan=new UIColor("cyan"),UIColor.Blue=new UIColor("blue"),UIColor.Violet=new UIColor("violet"),UIColor.Purple=new UIColor("purple"),UIColor.Magenta=new UIColor("magenta"),UIColor.Primary=new UIColor("primary"),UIColor.Accent=new UIColor("accent"),UIColor.Background=new UIColor("background"),UIColor.Text=new UIColor("text"),UIColor.Separator=new UIColor("separator"),UIColor.ControlBase=new UIColor("controlBase");class UITheme{constructor(){this.modalDialogShadeOpacity=.3,this.spacing=8,this.colors={black:"#000000",darkerGray:"#333333",darkGray:"#777777",gray:"#aaaaaa",lightGray:"#dddddd",white:"#ffffff",slate:"#667788",red:"#ff0000",orange:"#ee9933",yellow:"#ffff00",lime:"#77ff00",green:"#007700",turquoise:"#33aa99",cyan:"#00ffff",blue:"#0000ff",violet:"#ee77cc",purple:"#aa3399",magenta:"#ff00ff",primary:"@blue",accent:"@purple",background:"@white",text:"@background.text",separator:"@background^-50%/20%",controlBase:"@background",modalShade:"@black"},this.icons=Object.create(null),this.styles={container:UIStyle.create("_container",{position:{gravity:"stretch"},dimensions:{grow:1,shrink:0},containerLayout:{gravity:"stretch",axis:"vertical",distribution:"start",wrapContent:!1}}),scroll:UIStyle.create("_scroll",{dimensions:{grow:1,shrink:1}}),cell:UIStyle.create("_cell",{containerLayout:{distribution:"center",gravity:"center"},position:{top:0}}),cell_flow:UIStyle.create("_cell_flow",{dimensions:{grow:0,shrink:0}}),cell_cover:UIStyle.create("_cell_cover",{position:{gravity:"overlay",top:0,bottom:0,left:0,right:0,start:0,end:0}}),form:UIStyle.create("_form",{dimensions:{grow:0}}),column:UIStyle.create("_column",{containerLayout:{axis:"vertical",gravity:"start"},dimensions:{grow:0,shrink:0}}),row:UIStyle.create("_row",{containerLayout:{axis:"horizontal",gravity:"center"},dimensions:{grow:0,shrink:0}}),row_opposite:UIStyle.create("_row_opposite",{containerLayout:{distribution:"end"}}),row_center:UIStyle.create("_row_center",{containerLayout:{distribution:"center"}}),control:UIStyle.create("_control",{dimensions:{shrink:1,grow:0}})}}static getStyle(e,t){let n=this.current.styles[e];return t&&this.current.styles[t]&&(n=n.mixin(this.current.styles[t])),n}static getTextColor(e){return this.isBrightColor(String(e))?"rgba(0,0,0,.8)":"rgba(255,255,255,.95)"}static isBrightColor(e){let t=String(e);if("#"===t[0])return 4===t.length&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]),.3*parseInt(t.slice(1,3),16)+.6*parseInt(t.slice(3,5),16)+.1*parseInt(t.slice(5,7),16)>140;if("rgb("===t.slice(0,4)||"rgba("===t.slice(0,5)){let e=t.slice(4).split(",").map(parseFloat);return.3*e[0]+.6*e[1]+.1*e[2]>140}return"hsl("!==t.slice(0,4)||parseFloat(t.slice(4).split(",")[2])>55}static mixColors(e,t,n){function i(e){let t=[0,0,0,1];return"#"===e[0]?(4===e.length&&(e="#"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),t[0]=parseInt(e.slice(1,3),16),t[1]=parseInt(e.slice(3,5),16),t[2]=parseInt(e.slice(5,7),16)):"rgba("===e.slice(0,5)?e.slice(5).split(",").forEach(((e,n)=>{t[n]=parseFloat(e)})):"rgb("===e.slice(0,4)?e.slice(4).split(",").forEach(((e,n)=>{t[n]=parseFloat(e)})):"transparent"===e&&(t[3]=0),t}let o=1-n;function r(e,t){return e===t?e:isNaN(e)?t:isNaN(t)?e:Math.floor(o*e+n*t)}let s=i(String(e)),a=i(String(t)),l=r(s[0],a[0])+","+r(s[1],a[1])+","+r(s[2],a[2]),c=o*s[3]+n*a[3];return c>=1?"rgb("+l+")":"rgba("+l+","+c+")"}static replaceColor(e){let t=String(e);return!t||e instanceof UIColor?t:t.replace(/\@(\w+)([.:]text)?((\^)?[\+\-]\d+\%)?([.:]text)?(\/\d+\%)?([.:]text)?/g,((e,t,n,i,o,r,s,a)=>{let l=this.current.colors[t]||"rgba(1,2,3,0)";if(/\@\w/.test(l)&&(l=this.replaceColor(l)),n&&(l=this.getTextColor(l)),i){let e=parseFloat(o?i.slice(1):i)/100;o&&!this.isBrightColor(l)&&(e=-e),l=this.mixColors(l,e>0?"#fff":"#000",Math.abs(e))}if(r&&(l=this.getTextColor(l)),s){let e=parseFloat(s.slice(1))/100;l=this.mixColors(l,"rgba(,,,0)",1-e)}return a&&(l=this.getTextColor(l)),l}))}clone(){let e=new UITheme;return e.modalDialogShadeOpacity=this.modalDialogShadeOpacity,e.spacing=this.spacing,e.ConfirmationDialogBuilder=this.ConfirmationDialogBuilder,e.MenuBuilder=this.MenuBuilder,e.colors=Object.assign({},this.colors),e.icons=Object.assign({},this.icons),e.styles=Object.assign({},this.styles),e}setStyle(e,t){return this.styles[e]&&(t=Object.assign(Object.assign({},this.styles[e].getStyles()),t)),this.styles[e]=UIStyle.create(e,t)}}const G=new UIStyle;class UIComponentEvent extends ComponentEvent{constructor(e,t,n,i){super(e,t,n),this.event=i}}class UIBeforeRenderEvent extends ManagedEvent{constructor(e){super("BeforeRender"),this.source=e}}class UIRenderEvent extends ManagedEvent{constructor(e,t){super("UIRender"),this.source=e,this.renderCallback=t}}var Y,X;e.UIFocusRequestType=void 0,(Y=e.UIFocusRequestType||(e.UIFocusRequestType={}))[Y.SELF=0]="SELF",Y[Y.FORWARD=1]="FORWARD",Y[Y.REVERSE=-1]="REVERSE";class UIFocusRequestEvent extends ManagedEvent{constructor(t,n=e.UIFocusRequestType.SELF){super("UIFocusRequest"),this.source=t,this.direction=n}}class UIComponent extends Component{constructor(){super(...arguments),this._style=G}static preset(e,...t){let n,i;e.requestFocus&&(delete e.requestFocus,e.onRendered=function(){this._requestedFocusBefore||(this._requestedFocusBefore=!0,this.requestFocus())}),"string"==typeof e.style?i=e.style:n=e.style;let o,r,s,a=e.dimensions,l=e.position;delete e.style,delete e.dimensions,delete e.position,Binding.isBinding(n)&&(this.presetBinding("style",n,(function(e){this.style=e?o.mixin(e):o})),n=void 0),Binding.isBinding(a)&&(this.presetBinding("dimensions",a,(function(e){this.dimensions=e?Object.assign(Object.assign({},r),e):r})),a=void 0),Binding.isBinding(l)&&(this.presetBinding("position",l,(function(e){this.position=e?Object.assign(Object.assign({},s),e):s})),l=void 0);let c=super.preset(e,...t);return function(){c.call(this);let e=n||i&&UITheme.current.styles[i];e?this._style===G?this.style=e:this.style=this._style.mixin(e):o=this.style,a?this.dimensions=Object.assign(Object.assign({},this.dimensions),a):r=this.dimensions,l?this.position=Object.assign(Object.assign({},this.position),l):s=this.position}}propagateComponentEvent(e,t,n){this.managedState&&(!n&&t instanceof UIComponentEvent&&(n=t.event),this.emit(UIComponentEvent,e,this,t,n))}delegateEvent(e,t){if(!0!==super.delegateEvent(e,t)&&e instanceof UIComponentEvent)return this.emit(e),!0}render(e){this._firstRendered||(this._firstRendered=!0,this.emit(UIBeforeRenderEvent,this)),this.emit(UIRenderEvent,this,e)}isFocusable(){return!1}isKeyboardFocusable(){return!1}requestFocus(){this.emit(UIFocusRequestEvent,this)}requestFocusNext(){this.emit(UIFocusRequestEvent,this,e.UIFocusRequestType.FORWARD)}requestFocusPrevious(){this.emit(UIFocusRequestEvent,this,e.UIFocusRequestType.REVERSE)}applyStyle(e){e&&(this.dimensions=e.getStyles().dimensions,this.position=e.getStyles().position)}get style(){return this._style}set style(e){if(e!==this._style){if(!(e instanceof UIStyle))throw r(43);this.applyStyle(this._style=e)}}}!function(e){e.DynamicRendererWrapper=class DynamicRendererWrapper{constructor(){this._seq=0}render(e,t){if(this._seq++,!e&&this._renderCallback&&(this._renderCallback=this._renderCallback(void 0)),t&&t!==this._renderCallback&&(this._renderCallback&&this._renderCallback(void 0),this._renderCallback=t),e&&this._renderCallback){let t=this._seq,n=(e,i)=>(t===this._seq&&(this._renderCallback=this._renderCallback(e,i),t=++this._seq),n);e.render(n)}}removeAsync(){if(this._renderCallback)return new Promise((e=>{this._renderCallback=this._renderCallback(void 0,e),this._seq++}))}}}(UIComponent||(UIComponent={}));class UIContainer extends UIComponent{constructor(...e){super(),this.content=(new ManagedList).restrict(Component).propagateEvents(ComponentEvent),e.length&&this.content.replace(e)}static preset(e,...t){let n,i=e.layout;delete e.layout,Binding.isBinding(i)&&(this.presetBinding("layout",i,(function(e){this.layout=e?Object.assign(Object.assign({},n),e):n})),i=void 0);let o=super.preset(e,...t);return function(){o.call(this),i?this.layout=Object.assign(Object.assign({},this.layout),i):n=this.layout,t.length&&this.content.add(...t.filter((e=>!!e)).map((e=>new e)))}}applyStyle(e){e&&(super.applyStyle(e),this.layout=e.getStyles().containerLayout)}isFocusable(){return!(!this.allowFocus&&!this.allowKeyboardFocus)}isKeyboardFocusable(){return!!this.allowKeyboardFocus}}i([z,U],UIContainer.prototype,"content",void 0),e.UICellTransition=void 0,(X=e.UICellTransition||(e.UICellTransition={})).right="right",X.left="left",X.up="up",X.down="down",X.fade="fade",X.rightFast="right-fast",X.leftFast="left-fast",X.upFast="up-fast",X.downFast="down-fast",X.fadeFast="fade-fast";class UICell extends UIContainer{constructor(...e){super(...e),this.style=UITheme.getStyle("container","cell")}static preset(e,...t){let n,i=e.decoration;delete e.decoration,Binding.isBinding(i)&&(this.presetBinding("decoration",i,(function(e){this.decoration=e?Object.assign(Object.assign({},n),e):n})),i=void 0),e.allowKeyboardFocus&&(e.allowFocus=e.allowKeyboardFocus),e.selectOnFocus&&(e.allowFocus=!0,e.onFocusIn="Select",delete e.selectOnFocus);let o=super.preset(e,...t);return function(){o.call(this),i&&(this.decoration=Object.assign(Object.assign({},this.decoration),i))}}isFocusable(){return!(!this.allowFocus&&!this.allowKeyboardFocus)}isKeyboardFocusable(){return!!this.allowKeyboardFocus}applyStyle(e){e&&(super.applyStyle(e),this.decoration=e.getStyles().decoration)}}let J=UICell.with({style:"cell_flow"}),Q=UICell.with({style:"cell_cover"});class UIColumn extends UIContainer{constructor(...e){super(...e),this.spacing=UITheme.current.spacing,this.style=UITheme.getStyle("container","column")}static preset(e,...t){return super.preset(e,...t)}hasComponentSpacing(){return!!this.spacing}}let Z=UIColumn.with({spacing:0});const ee=F("renderContext"),te=F("renderContext.viewportContext");var ne;e.UIRenderPlacement=void 0,(ne=e.UIRenderPlacement||(e.UIRenderPlacement={}))[ne.NONE=0]="NONE",ne[ne.PAGE=1]="PAGE",ne[ne.MODAL=2]="MODAL",ne[ne.DIALOG=3]="DIALOG",ne[ne.DRAWER=4]="DRAWER",ne[ne.DROPDOWN=5]="DROPDOWN",ne[ne.DROPDOWN_COVER=6]="DROPDOWN_COVER",ne[ne.POPOVER=7]="POPOVER",ne[ne.POPOVER_ABOVE=8]="POPOVER_ABOVE",ne[ne.POPOVER_LEFT=9]="POPOVER_LEFT",ne[ne.POPOVER_RIGHT=10]="POPOVER_RIGHT";class UIRenderContext extends ManagedObject{emitRenderChange(){this.emitChange()}getAppComponents(){return this.getManagedReferrers().filter((e=>e instanceof AppComponent))}}!function(e){e.Output=class Output{constructor(e,t,n,i){this.source=e,this.element=t,this.placement=n,this.placementRef=i}}}(UIRenderContext||(UIRenderContext={}));class UIRenderableController extends(Component.with({renderContext:ee})){constructor(e){super(),this._renderer=new UIComponent.DynamicRendererWrapper,this.content=e||(this._ContentClass?new this._ContentClass:void 0)}static preset(e,t){return this.prototype._ContentClass=t,super.preset(e,t)}delegateEvent(e,t){if(!0!==super.delegateEvent(e,t)&&e instanceof UIComponentEvent)return this.emit(e),!0}render(e){this._renderer.render(this.content,e)}}i([x],UIRenderableController.prototype,"renderContext",void 0),i([z,N],UIRenderableController.prototype,"content",void 0),UIRenderableController.addObserver(class{constructor(e){this.component=e}onContentChange(){this.component.render()}});const ie=UICell.with({style:"form",accessibleRole:"form"});class UIForm extends UIRenderableController{static preset(e,...t){let n=e.formContext||F("formContext");delete e.formContext;let i=ie.with(e,...t);return this.presetBoundComponent("content",i).limitBindings("formContext"),super.preset({formContext:n},i)}}i([x],UIForm.prototype,"formContext",void 0);class UIRow extends UIContainer{constructor(...e){super(...e),this.spacing=UITheme.current.spacing,this.style=UITheme.getStyle("container","row")}static preset(e,...t){return super.preset(e,...t)}hasComponentSpacing(){return!!this.spacing}}let oe=UIRow.with({style:"row_opposite"}),re=UIRow.with({style:"row_center"}),se=UIRow.with({spacing:0});class UIScrollTargetEvent extends ManagedEvent{constructor(e,t,n,i){super("UIScrollTarget"),this.source=e,this.target=t,this.yOffset=n,this.xOffset=i}}class UIScrollEvent extends UIComponentEvent{}class UIScrollContainer extends UIContainer{constructor(...e){super(...e),this.topThreshold=0,this.bottomThreshold=0,this.horizontalThreshold=0,this.verticalScrollEnabled=!0,this.horizontalScrollEnabled=!0,this._vertScrollState={up:!1,down:!1,slowing:0,high:0,velocity:0},this._horzScrollState={start:!1,end:!1,slowing:0,high:0,velocity:0},this.style=UITheme.getStyle("container","scroll")}static preset(e,...t){return super.preset(e,...t)}scrollTo(e,t){this.emit(new UIScrollTargetEvent(this,void 0,e,t).freeze())}scrollToTop(){this.emit(new UIScrollTargetEvent(this,"top").freeze())}scrollToBottom(){this.emit(new UIScrollTargetEvent(this,"bottom").freeze())}handleScrollSnap(e){if(this.horizontalSnap||this.verticalSnap){let t=this._vertScrollState,n=this._horzScrollState;"ScrollEnd"===e.name?(t.up=t.down=!1,n.start=n.end=!1,t.high=0,n.high=0):(e.scrolledUp&&t.up||e.scrolledDown&&t.down?e.verticalVelocity>=t.velocity?(t.slowing=0,e.verticalVelocity>t.high&&(t.high=e.verticalVelocity)):(t.slowing++,t.slowing>1&&e.verticalVelocity<.75*t.high&&(t.slowing=t.high=0,t.up&&"start"===this.verticalSnap&&this.emitAction("ScrollSnapUp",e),t.down&&"end"===this.verticalSnap&&this.emitAction("ScrollSnapDown",e))):(t.slowing=0,t.high=0),t.up=!!e.scrolledUp,t.down=!!e.scrolledDown,t.velocity=e.verticalVelocity,e.scrolledHorizontalStart&&n.start||e.scrolledHorizontalEnd&&n.end?e.horizontalVelocity>=n.velocity?(n.slowing=0,e.horizontalVelocity>n.high&&(n.high=e.horizontalVelocity)):(n.slowing++,n.slowing>1&&e.horizontalVelocity<.75*n.high&&(n.slowing=n.high=0,n.start&&"start"===this.horizontalSnap&&this.emitAction("ScrollSnapHorizontalStart",e),n.end&&"end"===this.horizontalSnap&&this.emitAction("ScrollSnapHorizontalEnd",e))):(n.slowing=0,n.high=0),n.start=!!e.scrolledHorizontalStart,n.end=!!e.scrolledHorizontalEnd,n.velocity=e.horizontalVelocity)}}}UIScrollContainer.addEventHandler((function(e){e instanceof UIScrollEvent&&this.handleScrollSnap(e)}));class UIControl extends UIComponent{constructor(){super(...arguments),this.shrinkwrap=!0}static preset(e){let t,n,i=e.decoration,o=e.textStyle;delete e.decoration,delete e.textStyle,Binding.isBinding(i)&&(this.presetBinding("decoration",i,(function(e){this.decoration=e?Object.assign(Object.assign({},t),e):t})),i=void 0),Binding.isBinding(o)&&(this.presetBinding("textStyle",o,(function(e){this.textStyle=e?Object.assign(Object.assign({},n),e):n})),o=void 0);let r=super.preset(e);return function(){r.call(this),i?this.decoration=Object.assign(Object.assign({},this.decoration),i):t=this.decoration,o?this.textStyle=Object.assign(Object.assign({},this.textStyle),o):n=this.textStyle}}applyStyle(e){e&&(super.applyStyle(e),this.decoration=e.getStyles().decoration,this.textStyle=e.getStyles().textStyle)}}class UIButton extends UIControl{constructor(e){super(),this.style=UITheme.getStyle("control","button"),void 0!==e&&(this.label=e)}static preset(e){return"text"in e&&(e.label=e.text),!e.navigateTo&&!e.navigationTarget||e.accessibleRole||(e.accessibleRole="link"),super.preset(e)}static withLabel(e,t){return"string"==typeof e&&(e=D(e)),this.with({label:e,onClick:t})}static withIcon(e,t,n,i){return this.with({icon:e,iconSize:n,iconColor:i,onClick:t})}isFocusable(){return!0}isKeyboardFocusable(){return!this.disableKeyboardFocus}getNavigationTarget(){return this.navigationTarget||this.navigateTo}}let ae=UIButton.with({style:"button_primary"}),le=UIButton.with({style:"button_borderless"}),ce=UIButton.with({style:"button_outline"}),de=UIButton.with({style:"button_link"}),he=UIButton.with({style:"button_large"}),ue=UIButton.with({style:"button_small"}),pe=UIButton.with({style:"button_icon"});class UIImage extends UIControl{constructor(e){super(),this.style=UITheme.getStyle("control","image"),void 0!==e&&(this.url=e)}static withUrl(e,t){return this.with({url:e,style:t})}static preset(e){return e.allowKeyboardFocus&&(e.allowFocus=e.allowKeyboardFocus),super.preset(e)}isFocusable(){return!(!this.allowFocus&&!this.allowKeyboardFocus)}isKeyboardFocusable(){return!!this.allowKeyboardFocus}}class UILabel extends UIControl{constructor(e){super(),this.htmlFormat=!1,this.style=UITheme.getStyle("control","label"),void 0!==e&&(this.text=e)}static withText(e,t){return"string"==typeof e&&(e=D(e)),t instanceof UIStyle||"string"==typeof t?this.with({text:e,style:t}):t?this.with({text:e,textStyle:t}):this.with({text:e})}static withIcon(e,t,n){return this.with({icon:e,iconSize:t,iconColor:n})}static preset(e){return e.allowKeyboardFocus&&(e.allowFocus=e.allowKeyboardFocus),super.preset(e)}isFocusable(){return!(!this.allowFocus&&!this.allowKeyboardFocus)}isKeyboardFocusable(){return!!this.allowKeyboardFocus}}let me=UILabel.with({headingLevel:1,style:"heading1"}),ge=UILabel.with({headingLevel:2,style:"heading2"}),fe=UILabel.with({headingLevel:3,style:"heading3"}),ve=UILabel.with({style:"paragraph"}),ye=UILabel.with({style:"label_close"}),be=UILabel.with({shrinkwrap:!1});class UISeparator extends UIControl{constructor(){super(),this.thickness=1,this.color="@separator",this.style=UITheme.getStyle("control","separator")}static preset(e){return super.preset(e)}}class UISpacer extends UIControl{static preset(e){return void 0!==e.height&&((e.dimensions||(e.dimensions={})).minHeight=e.height,e.shrinkwrap=!0),void 0!==e.width&&((e.dimensions||(e.dimensions={})).minWidth=e.width,e.shrinkwrap=!0),super.preset(e)}static withHeight(e,t=!0){return this.with({dimensions:{minHeight:e},shrinkwrap:t})}static withWidth(e,t=!0){return this.with({dimensions:{minWidth:e},shrinkwrap:t})}constructor(e,t,n){super(),this.style=UITheme.getStyle("control","spacer"),void 0!==e||void 0!==t?this.dimensions=Object.assign(Object.assign({},this.dimensions),{width:void 0!==e?e:this.dimensions.width,height:void 0!==t?t:this.dimensions.height,grow:0,shrink:n?1:0}):this.shrinkwrap=!1}}const Ce=F("formContext"),we=AppException.type("FORM_REQUIRED","%s is required");class UIFormContextChangeEvent extends ManagedChangeEvent{constructor(e){super("FormChange"),this.source=e}}class UIFormContext extends Component{constructor(){super(...arguments),this.errors=Object.create(null),this._values=Object.create(null),this._validations=Object.create(null),this._changeEvent=new UIFormContextChangeEvent(this).freeze()}static create(e){let t=new UIFormContext;return t._values=e,t}get(e){if(void 0!==e)return this._values[e]}has(e){return e in this._values}set(e,t,n,i){if(e)if("number"==typeof this._values[e]&&(t=+t),this._values[e]!==t)this._values[e]=t,n&&this.validate(e),i||this.emit(this._changeEvent);else if(n){let t=!!this.errors[e];this.validate(e);let n=!!this.errors[e];i||!t&&!n||this.emit(this._changeEvent)}}unset(e){e&&e in this._values&&(delete this._values[e],delete this.errors[e],this.emit(this._changeEvent))}clear(){this._values=Object.create(null);for(let e in this.errors)delete this.errors[e];this.emit(this._changeEvent)}serialize(){let e=Object.create(null);for(let t in this._values)e[t]=this._values[t];return e}required(e,t){return this.test(e,(e=>e.required(t))),this}test(e,t){return this._validations[e]=t,this}validate(e){let t=this._values[e];if(this._validations[e])try{let n=new UIFormContext.ValidationTest(e,t);this._validations[e](n),this.errors[e]=void 0}catch(t){this.errors[e]=t}else this.errors[e]=void 0;return!this.errors[e]}validateAll(){for(let e in this._validations)this.validate(e);return this}get errorCount(){let e=0;for(let t in this.errors)this.errors[t]&&e++;return e}get valid(){for(let e in this.errors)if(this.errors[e])return!1;return!0}}!function(e){e.ValidationTest=class ValidationTest{constructor(e,t){this.name=e,this.value=t}required(e){if(0!==this.value&&!this.value)throw new we(e||this.name);return this}typeOf(e){if(typeof this.value!==e)throw new TypeError;return this}assert(e,t){let n=AppException.type("FORM_TEST",t);if(!e)throw new n(this.value);return this}}}(UIFormContext||(UIFormContext={}));class UITextField extends UIControl{constructor(){super(),this.type="text",this.style=UITheme.getStyle("control","textfield"),this.shrinkwrap=!1}static preset(e){return"text"in e&&(e.placeholder=e.text),super.preset(e)}static withName(e,t){return this.with({name:e,placeholder:t})}isFocusable(){return!0}isKeyboardFocusable(){return!0}}UITextField.UITextFieldObserver=class UITextFieldObserver{constructor(e){this.component=e}onFormContextChange(){if(this.component.formContext&&this.component.name){let e=this.component.formContext.get(this.component.name);this.component.value=void 0===e?"":String(e)}}onInput(){var e;null===(e=this.component.formContext)||void 0===e||e.set(this.component.name,this.component.value)}onChange(){var e;null===(e=this.component.formContext)||void 0===e||e.set(this.component.name,this.component.value,!0)}},i([x],UITextField.prototype,"formContext",void 0),i([m],UITextField,"UITextFieldObserver",void 0),UITextField.presetBinding("formContext",Ce);let Ie=UITextField.with({style:"textfield_borderless"});class UIToggle extends UIControl{constructor(){super(),this.style=UITheme.getStyle("control","toggle")}static preset(e){return"text"in e&&(e.label=e.text),super.preset(e)}static withName(e,t){return this.with({name:e,label:t})}isFocusable(){return!0}isKeyboardFocusable(){return!0}}UIToggle.UIToggleObserver=class UIToggleObserver{constructor(e){this.component=e}onFormContextChange(){if(this.component.formContext&&this.component.name){let e=this.component.formContext.get(this.component.name);this.component.state=!!e}}onStateChange(){var e;null===(e=this.component.formContext)||void 0===e||e.set(this.component.name,this.component.state,!0)}},i([x],UIToggle.prototype,"formContext",void 0),i([m],UIToggle,"UIToggleObserver",void 0),UIToggle.presetBinding("formContext",Ce);class UIConditional extends UIRenderableController{static preset(e,t){return this.presetBindingsFrom(t),this.prototype._ConditionalContentClass=t,super.preset(e)}}UIConditional.UIConditionalObserver=class{constructor(e){this.component=e}onStateChange(){this.component._ConditionalContentClass&&!!this.component.content!=!!this.component.state&&(this.component.content=this.component.state?new this.component._ConditionalContentClass:void 0)}},i([m],UIConditional,"UIConditionalObserver",void 0);class UIFormContextController extends UIRenderableController{static preset(e,t){return t&&this.presetBoundComponent("content",t).limitBindings("formContext"),super.preset(e,t)}}i([x],UIFormContextController.prototype,"formContext",void 0);class UIListCellAdapterEvent extends ActionEvent{constructor(e,t,n){if(super(e,t,n),!t.content)throw TypeError();this.context=t.object,this.object=t.object,this.cell=t.content,this.value=t.value}}class UIListCellAdapter extends UIRenderableController{constructor(e){super(),this._selected=!1,this._hovered=!1,this.object=e,this.value=e.valueOf()}static preset(e,...t){let n={},i={};for(let t in e)("o"===t[0]&&"n"===t[1]&&(t.charCodeAt(2)<97||t.charCodeAt(2)>122)?i:n)[t]=e[t];n.accessibleRole||(n.accessibleRole="listitem");let o=UICell.with(n,...t);return this.presetBoundComponent("content",o).limitBindings("object","value","selected","hovered"),super.preset(i,o)}propagateComponentEvent(e,t){this.managedState&&this.emit(UIListCellAdapterEvent,e,this,t)}emitAction(e,t,n){let i=new UIListCellAdapterEvent(e,this,t);i.context=n,this.emit(i.freeze())}delegateEvent(e,t){return(e instanceof ActionEvent&&!(e instanceof UIListCellAdapterEvent)||e instanceof UIComponentEvent)&&(e=new UIListCellAdapterEvent(e.name,this,e)),super.delegateEvent(e,t)}get selected(){return this._selected}get hovered(){return this._hovered}requestFocus(){this.content&&this.content.requestFocus()}requestFocusNext(){this.content&&this.content.requestFocusNext()}requestFocusPrevious(){this.content&&this.content.requestFocusPrevious()}}UIListCellAdapter.UIListCellAdapterObserver=class{constructor(e){this.adapter=e}onSelect(e){e.source!==this.adapter&&e.source!==this.adapter.content||(this.adapter._selected=!0)}onDeselect(e){e.source!==this.adapter&&e.source!==this.adapter.content||(this.adapter._selected=!1)}onMouseEnter(e){e.source!==this.adapter&&e.source!==this.adapter.content||(this.adapter._hovered=!0)}onMouseLeave(e){e.source!==this.adapter&&e.source!==this.adapter.content||(this.adapter._hovered=!1)}},i([x],UIListCellAdapter.prototype,"object",void 0),i([g("_selected")],UIListCellAdapter.prototype,"selected",null),i([g("_hovered")],UIListCellAdapter.prototype,"hovered",null),i([m],UIListCellAdapter,"UIListCellAdapterObserver",void 0);const _e=Z.with({accessibleRole:"list"}),Se=Promise.resolve();class UIListController extends UIRenderableController{constructor(){super(...arguments),this.items=new ManagedList,this.firstIndex=0,this.lastFocusedIndex=0,this._updateQueued=!1,this._contentMap=new ManagedMap}static preset(e,t,n=_e,i){return this.presetBindingsFrom(t,i),this.addObserver(class{constructor(e){this.controller=e,this.Adapter=t,!this.Adapter||this.Adapter.prototype instanceof ManagedObject||(this.Adapter=this.Adapter(this)),this.BookEnd=i}onFocusIn(e){if(e.source!==this.controller.content){let t=this.controller.getIndexOfComponent(e.source);this.controller.lastFocusedIndex=Math.max(0,t)}else this.controller.restoreFocus()}onFirstIndexChangeAsync(){return this.controller._doUpdateAsync(this.Adapter,this.BookEnd)}onMaxItemsChangeAsync(){return this.controller._doUpdateAsync(this.Adapter,this.BookEnd)}onItemsChange(e,t){(!t||t instanceof ManagedListChangeEvent)&&this.controller._doUpdateAsync(this.Adapter,this.BookEnd)}}),super.preset(e,n)}onFocusIn(e){if(e.source!==this.content){let t=this.getIndexOfComponent(e.source);this.lastFocusedIndex=Math.max(0,t)}else this.restoreFocus();return!0}onArrowUpKeyPress(){if(!this.focusPreviousItem()){let e=this.getParentComponent(UIListController);e&&e.enableArrowKeyFocus&&e.restoreFocus()}return!0}onArrowDownKeyPress(){if(!this.focusNextItem()){let e=this.getParentComponent(UIListController);if(e&&e.enableArrowKeyFocus)return!1}return!0}getIndexOfComponent(e){let t=this.content;if(!t)return-1;for(;e&&e.getParentComponent()!==t;)e=e.getParentComponent();return e?t.content.indexOf(e):-1}restoreFocus(){let e=this.content;if(e&&e.content.count>0){let t=Math.max(this.lastFocusedIndex,0),n=Math.min(e.content.count-1,t),i=e.content.get(n);"function"==typeof i.requestFocus&&i.requestFocus()}}focusPreviousItem(){return this.lastFocusedIndex>0&&(this.lastFocusedIndex--,this.restoreFocus(),!0)}focusNextItem(){return this.lastFocusedIndex<this.items.count-1&&(this.lastFocusedIndex++,this.restoreFocus(),!0)}_doUpdateAsync(e,t){return o(this,void 0,void 0,(function*(){if(this._updateQueued)return;this._updateQueued=!0,yield Se,this._updateQueued=!1;let n=this.content,i=n&&n.content,o=this.items;if(!i)return;if(!o||!e)return void i.clear();let r=this.firstIndex;r>=0||(r=0);let s=this.maxItems,a=r>0||s>=0?o.count>0&&r<o.count?o.take(s>=0?s:o.count,o.get(this.firstIndex)):[]:o,l=this._contentMap,c=[],d=l.toObject();for(let t of a){let n=d[t.managedId];n?delete d[t.managedId]:(n=new e(t),l.set(String(t.managedId),n)),c.push(n)}t&&(i.last()instanceof t?c.push(i.last()):c.push(new t)),i.replace(c);for(let e in d)l.remove(d[e]);this.enableArrowKeyFocus&&(n.allowKeyboardFocus=!!c.length),this.managedState&&this.emitAction("ListItemsChange")}))}}i([x],UIListController.prototype,"items",void 0);class UIModalController extends UIRenderableController{constructor(){super(...arguments),this.placement=e.UIRenderPlacement.MODAL}static preset(e,t,n){let i=n||e.modal;if(delete e.modal,Binding.isBinding(i))throw r(45);return t&&this.presetBoundComponent("content",t).limitBindings(),i&&(this.presetBoundComponent("modal",i).limitBindings(),this.prototype._ModalClass=i),super.preset(e,t)}onShowModal(){return this.showModal(),!0}onCloseModal(){return this.closeModal(),!0}showModal(){this._ModalClass&&(this.modal=new this._ModalClass)}closeModal(){this.modal=void 0}}i([z,U],UIModalController.prototype,"modal",void 0),UIModalController.addObserver(class{constructor(e){this.controller=e}onModalChange(){if(this._renderCallback&&(this._renderCallback=this._renderCallback(void 0)),this.controller.modal&&this.controller.renderContext&&this._getReferenceComponent()){this._renderCallback=this.controller.renderContext.getRenderCallback();let e=(t,n)=>this._renderCallback?(t&&t.element?(void 0===t.modalShadeOpacity&&(t.modalShadeOpacity=this.controller.modalShadeOpacity),t.placement||(t.placement=this.controller.placement,t.placementRef=this._getReferenceComponent()),this._renderCallback=this._renderCallback(t,n)):(this._renderCallback=this._renderCallback(void 0),this.controller.modal=void 0),e):e;this.controller.modal.render(e)}}_getReferenceComponent(){let e=this.controller;for(;e;){if(e instanceof UIComponent)return e;e instanceof UIRenderableController&&(e=e.content)}}});class UISelectionController extends UIRenderableController{onSelect(e){if(e.source===this.selected)return;for(;e.inner instanceof ComponentEvent&&"Select"===e.inner.name;)if((e=e.inner).source===this.selected)return;let t=this.selected;this.selected=e.source,t&&t.managedState&&t.emitAction("Deselect")}onDeselect(e){for(e.source===this.selected&&(this.selected=void 0);e.inner instanceof ComponentEvent&&"Deselect"===e.inner.name;)(e=e.inner).source===this.selected&&(this.selected=void 0)}}i([x],UISelectionController.prototype,"selected",void 0);class UIStyleController extends UIRenderableController{static preset(e,t){return super.preset(e,t)}}UIStyleController.addObserver(class{constructor(e){this.controller=e,this._initial=!0}onContentChange(){let e=this.controller.content;if(e instanceof UIComponent){let t=e.style,n=Object.create(null),i=0;UIStyle.isStyleOverride(e.dimensions,t)&&(n.dimensions=e.dimensions,i++),UIStyle.isStyleOverride(e.position,t)&&(n.position=e.position,i++),e instanceof UIContainer&&(UIStyle.isStyleOverride(e.layout,t)&&(n.containerLayout=e.layout,i++),e instanceof UICell&&UIStyle.isStyleOverride(e.decoration,t)&&(n.decoration=e.decoration,i++)),e instanceof UIControl&&(UIStyle.isStyleOverride(e.decoration,t)&&(n.decoration=e.decoration,i++),UIStyle.isStyleOverride(e.textStyle,t)&&(n.textStyle=e.textStyle,i++)),this.controller.baseStyle=i?t.extend(n):t,this.onStateChange()}}onStateChange(){var e;let t=this.controller;if(t.baseStyle&&t.content instanceof UIComponent){let n=t.baseStyle,i=null===(e=t.styles)||void 0===e?void 0:e[String(t.state)];!i&&t.state&&(i=t.style),"string"==typeof i&&(i=UITheme.getStyle(i)),i instanceof UIStyle?(this._initial=!1,t.content.style=n.mixin(i)):this._initial||(t.content.style=n)}}});class UIMenuItemSelectedEvent extends UIComponentEvent{constructor(e,t,n){super(e,t),this.key=n}}class UIMenu extends Component{constructor(){if(super(),this.options=[],!UITheme.current.MenuBuilder)throw r(44);this.builder=new UITheme.current.MenuBuilder}static preset(e){return super.preset(e)}render(e){if(this.options.length){this.builder.clear();for(let e of this.options)this.builder.addOption(e.key,String(e.text))}this.gravity&&this.builder.setGravity(this.gravity),this.emitAction("Build");let t=this.builder.build();(this.menu=new t).render(e)}onSelectMenuItem(e){return this.selected=e.key,this.emit(e),!0}}i([z,N],UIMenu.prototype,"menu",void 0);class UIViewRenderer extends Component{constructor(){super(...arguments),this.index=0,this._renderer=new UIComponent.DynamicRendererWrapper}static preset(e){return super.preset(e)}static withBoundContent(e="content"){return this.with({view:F(e)})}delegateEvent(e,t){if(!0!==super.delegateEvent(e,t)&&e instanceof UIComponentEvent)return this.emit(e),!0}render(e){(e||this.view!==this._lastRendered)&&(this._lastRendered=this.view,this._renderer.render(this.view,e))}}i([x],UIViewRenderer.prototype,"managedList",void 0),i([x],UIViewRenderer.prototype,"managedMap",void 0),i([z,x],UIViewRenderer.prototype,"view",void 0);class UIViewRendererObserver{constructor(e){this.component=e}onViewChange(){this.component.render()}updateView(){if(this.component.index>=0&&this.component.managedList&&this.component.index<this.component.managedList.count){let e=this.component.index;this.component.view=this.component.managedList.get(e)}else"string"==typeof this.component.index&&this.component.managedMap&&this.component.managedMap.has(this.component.index)?this.component.view=this.component.managedMap.get(this.component.index):this.component.view=void 0}}i([f("managedList","managedMap","index")],UIViewRendererObserver.prototype,"updateView",null),UIViewRenderer.addObserver(UIViewRendererObserver);const xe=F("activationContext");class AppComponent extends(Component.with({renderContext:ee,viewportContext:te,activationContext:xe})){}i([x],AppComponent.prototype,"renderContext",void 0),i([x],AppComponent.prototype,"viewportContext",void 0),i([x],AppComponent.prototype,"activationContext",void 0);class AppActivity extends AppComponent{constructor(e,t){super(),this.name=e,this.path=t}static preset(e){return super.preset(e)}get match(){return this._matchedPath}getParentActivity(){return this.getManagedParent(AppActivity)}getApplication(){return this.getManagedParent(AppActivity.Application)}activateAsync(e){return o(this,void 0,void 0,(function*(){this._matchedPath=Object.freeze(e||{path:""}),yield this.activateManagedAsync()}))}destroyAsync(){return o(this,void 0,void 0,(function*(){yield this.destroyManagedAsync()}))}isActive(){return this.managedState===e.ManagedState.ACTIVE}onNavigate(e){var t,n,i;if(this.isActive()){for(;e.inner&&"Navigate"===e.inner.name;)e=e.inner;let o=String((null===(n=(t=e.source).getNavigationTarget)||void 0===n?void 0:n.call(t))||"");return o&&(null===(i=this.getApplication())||void 0===i||i.navigate(o)),!0}}}AppActivity.ActivityObserver=class{constructor(e){this.activity=e}onActive(){this.activity.activated=Date.now()}onInactive(){this.activity.deactivated=Date.now()}onPathChangeAsync(){return this.checkActivateAsync()}onActivationContextChangeAsync(){return this.checkActivateAsync()}checkActivateAsync(){return o(this,void 0,void 0,(function*(){if("string"==typeof this.activity.path){let t;this.activity.activationContext&&(t=this.activity.activationContext.match(this.activity.path,this.activity))?yield this.activity.activateAsync(t):this.activity.managedState!==e.ManagedState.ACTIVATING&&this.activity.managedState!==e.ManagedState.ACTIVE||(yield this.activity.deactivateManagedAsync())}}))}},i([g("_matchedPath")],AppActivity.prototype,"match",null),i([m],AppActivity,"ActivityObserver",void 0);class AppActivationContext extends ManagedObject{constructor(){super(...arguments),this._target="",this._split=[]}get target(){return this._target}set target(e){let t=String(e||"").replace(/^\/|\/\s*$/g,"");this._target!==t&&(this._target=t,this._split=t?t.split("/"):[],this.emitChange())}navigate(e,t){}match(e,t){for(e=String(e||"");t&&"."===e[0]&&"/"===e[1];)(t=t.getParentActivity())instanceof AppActivity&&"string"==typeof t.path&&(e=t.path.replace(/\/$/,"")+e.slice(1));let n=!1;"/"===e.slice(-1)&&(e=e.slice(0,-1),n=!0),"/"===e[0]&&(e=e.slice(1));let i=e?e.split("/"):[],o={path:this._target},s=0;for(;s<this._split.length;){if(s>=i.length)return n?o:void 0;if("*"===i[s][0]){if(i.length>s+1)throw r(0,e);return o[i[s].slice(1)]=this._split.slice(s).join("/"),o}if(":"===i[s][0]&&this._split[s])o[i[s].slice(1)]=this._split[s];else if(i[s]!==this._split[s])return;s++}return s===i.length?o:void 0}}class AppActivityList extends Component{constructor(){super(),this.$list=(new ManagedList).restrict(AppActivity),this.$list.propagateEvents((e=>e instanceof ActionEvent?e:e===ManagedCoreEvent.ACTIVE||e===ManagedCoreEvent.INACTIVE?a:void 0))}static preset(e,...t){return super.preset(e,...t),function(){this.add(...t.map((e=>new e)))}}get count(){return this.$list.count}add(...e){return this.$list.add(...e),this}remove(e){return this.$list.remove(e),this}clear(){return this.$list.clear(),this}get(e){return this.$list.get(e)}includes(e){return this.$list.includes(e)}forEach(e){this.$list.forEach(e)}map(e){return this.$list.map(e)}toArray(){return this.$list.toArray()}delegateEvent(e){this.emit(e)}}let Ue;i([z,U],AppActivityList.prototype,"$list",void 0);class Application extends Component{constructor(){super(...arguments),this.name="Application"}static run(...e){return(new(this.with(...e))).activate()}static preset(e,...t){if(t.length){let e=AppActivityList.with(...t);this.presetBoundComponent("activities",e),this.addEventHandler((function(t){t===ManagedCoreEvent.INACTIVE&&(this.activities=void 0),t===ManagedCoreEvent.ACTIVE&&(this.activities=new e,this.activities.map((e=>e.path)).filter((e=>!!e)).length||this.activities.forEach((e=>{e.activateAsync().catch(M)})))}))}return super.preset(e)}static setAutoUpdateHandler(e){Ue=e}static registerAutoUpdate(e,t,n){setTimeout((()=>{Ue&&Ue(e,t,n)}),10)}activate(){return this.activateAsync().catch(M),this}activateAsync(){return o(this,void 0,void 0,(function*(){yield this.activateManagedAsync()}))}deactivateAsync(){return o(this,void 0,void 0,(function*(){yield this.deactivateManagedAsync()}))}destroyAsync(){return o(this,void 0,void 0,(function*(){yield this.destroyManagedAsync()}))}navigate(e,t){return this.activationContext&&this.activationContext.navigate(String(e),t),this}goBack(){return this.activationContext&&this.activationContext.navigate("",{back:!0}),this}add(...e){return this.activities||(this.activities=new AppActivityList),this.activities.add(...e.filter((e=>!this.activities.includes(e)))),this}showViewActivityAsync(e){return o(this,void 0,void 0,(function*(){return this.add(e),yield e.activateAsync(),e}))}findService(e){return ManagedService.find(e)}}Application.active=(()=>{let e=new ManagedList;return Application.addObserver(class{constructor(e){this.instance=e}onActive(){e.includes(this.instance)||e.add(this.instance)}onInactive(){e.remove(this.instance)}}),e})(),i([z,U],Application.prototype,"activities",void 0),i([U],Application.prototype,"renderContext",void 0),i([U],Application.prototype,"activationContext",void 0),Application.presetBoundComponent("activities",AppActivity),AppActivity.Application=Application;class ViewActivity extends AppActivity{constructor(){super(...arguments),this.placement=e.UIRenderPlacement.NONE,this._renderer=new UIComponent.DynamicRendererWrapper}static autoUpdate(e){Application.registerAutoUpdate(e,this,"@reload")}static"@reload"(e,t){e.prototype._OrigClass&&(e=e.prototype._OrigClass),t.prototype._OrigClass=e;let n=Object.getOwnPropertyDescriptors(t.prototype);for(let t in n)Object.defineProperty(e.prototype,t,n[t]);let i=e.prototype._ViewClass=t.prototype._ViewClass;if(i&&e.prototype._PresetClass)for(var o in e.prototype._PresetClass.presetBoundComponent("view",i,AppActivity),e.prototype._allActive){var r=e.prototype._allActive[o];r.isActive()&&(r.view=new i)}}static preset(e,t){return t&&(this.presetBoundComponent("view",t,AppActivity),this.prototype._allActive||(this.prototype._allActive=Object.create(null)),this.prototype._ViewClass=t,this.prototype._PresetClass=this),super.preset(e)}render(e){if(this._cbContext!==this.renderContext&&(this._renderCallback=void 0,this._cbContext=this.renderContext),e&&e!==this._renderCallback&&(this._renderCallback&&this._renderCallback(void 0),this._renderCallback=e),!this._renderCallback){if(!this.placement)return;if(!this.renderContext)throw r(1);let e=this.placement,t=this.renderContext.getRenderCallback(),n=(i,o)=>(i&&(i.placement=e,i.modalShadeOpacity=this.modalShadeOpacity),t=t(i,o),n);this._renderCallback=n}this._renderer.render(this.view,this._renderCallback)}removeViewAsync(){return o(this,void 0,void 0,(function*(){yield this._renderer.removeAsync()}))}restoreFocus(e){e?this.firstFocused&&this.firstFocused.requestFocus():this.lastFocused&&this.lastFocused.requestFocus()}onFocusIn(e){e.source instanceof UIComponent&&(this.firstFocused||(this.firstFocused=e.source),this.lastFocused=e.source)}showModalAsync(e,t,n){return o(this,void 0,void 0,(function*(){let i=this.getApplication();if(!i)throw r(2);class SingletonActivity extends((null!=n?n:ModalViewActivity).with(e)){}return t&&(SingletonActivity.prototype.delegateEvent=t),i.showViewActivityAsync(new SingletonActivity)}))}showDialogAsync(e,t){return o(this,void 0,void 0,(function*(){return this.showModalAsync(e,t,DialogViewActivity)}))}showConfirmationDialogAsync(e,t,n,i){let o=UITheme.current.ConfirmationDialogBuilder;if(!o)throw r(3);let s=new o;Array.isArray(e)?e.forEach((e=>s.addMessage(e))):s.addMessage(e),t&&s.setTitle(t),n&&s.setConfirmButtonLabel(n),i&&s.setCancelButtonLabel(i);let a=s.build();return new Promise((e=>{this.showDialogAsync(a,(function(t){"Confirm"===t.name&&(e(!0),this.destroyAsync()),"CloseModal"===t.name&&i&&(e(!1),this.destroyAsync())}))}))}}ViewActivity.ViewActivityObserver=class{constructor(e){this.activity=e}onActive(){this.activity._allActive&&(this.activity._allActive[this.activity.managedId]=this.activity),this.activity._ViewClass&&(this.activity.view=new this.activity._ViewClass)}onInactive(){this.activity._allActive&&delete this.activity._allActive[this.activity.managedId],this.activity.view=void 0}onRenderContextChange(){return o(this,void 0,void 0,(function*(){this.activity.isActive()&&this.activity._ViewClass&&(this.activity.view=void 0,this.activity.renderContext&&(yield Promise.resolve(),setTimeout((()=>{!this.activity.view&&this.activity.renderContext&&this.activity.isActive()&&this.activity._ViewClass&&(this.activity.view=new this.activity._ViewClass)}),1)))}))}onViewChangeAsync(){this.checkAndRender()}checkAndRender(){this.activity.renderContext&&this.activity.view?this.activity.render():this.activity.removeViewAsync().catch(M)}},i([z,U],ViewActivity.prototype,"view",void 0),i([x],ViewActivity.prototype,"firstFocused",void 0),i([x],ViewActivity.prototype,"lastFocused",void 0),i([m],ViewActivity,"ViewActivityObserver",void 0);class ModalViewActivity extends ViewActivity{constructor(){super(),this.placement=e.UIRenderPlacement.MODAL,this.modalShadeOpacity=UITheme.current.modalDialogShadeOpacity}onCloseModal(){return this.destroyAsync(),!0}}class DialogViewActivity extends ModalViewActivity{constructor(){super(),this.placement=e.UIRenderPlacement.DIALOG}}class ViewComponent extends AppComponent{constructor(){if(super(),this._renderer=new UIComponent.DynamicRendererWrapper,this._Views)for(let e in this._Views)this[e]=new this._Views[e]}static preset(e,...t){if(t.length>1)throw r(4);return t[0]&&this.presetChildView("view",t[0],!0),super.preset(e)}static with(e,...t){if(!e||"function"==typeof e||!e.view)return Component.with.apply(this,arguments);let n=e;n.content||(n.content=["content"]);let i=n.defaults;class PresetViewComponent extends(this){constructor(e){super();const t=e=>{for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];if(n instanceof Binding)throw TypeError();this[t]=n}};i&&t(i),e&&t(e)}static preset(e,...t){for(let e=0;e<t.length;e++){let i=n.content[e];i&&t[e]&&(U(this.prototype,i),this.presetChildView(i,t[e]))}return super.preset(e)}isPresetComponent(){return!0}}if(PresetViewComponent.with=Component.with,"function"==typeof i){let e=i;i=void 0,PresetViewComponent._addInitializer((()=>{i=e()}))}return PresetViewComponent.presetChildView("view",n.view,!0),PresetViewComponent}static presetChildView(e,t,n=[]){let i=this.presetBoundComponent(e,t,ViewActivity);!0!==n&&i.limitBindings(...n),Object.prototype.hasOwnProperty.call(this.prototype,"_Views")||(this.prototype._Views=Object.create(this.prototype._Views||null)),this.prototype._Views[e]=t}delegateEvent(e,t){if(!0!==super.delegateEvent(e,t)&&e instanceof UIComponentEvent)return this.emit(e),!0}render(e){if(!this.renderContext)throw r(5);this.beforeRender(),this._renderer.render(this.view,e)}beforeRender(){}removeViewAsync(t){return o(this,void 0,void 0,(function*(){t&&this.managedState===e.ManagedState.ACTIVE&&(yield this.deactivateManagedAsync()),yield this._renderer.removeAsync()}))}requestFocus(){"function"==typeof(this.view&&this.view.requestFocus)&&this.view.requestFocus()}}i([z,N],ViewComponent.prototype,"view",void 0),ViewComponent.addObserver(class{constructor(e){this.component=e}onRenderContextChange(e){e?this.component.render():this.component.removeViewAsync(!0).catch(M)}});const Ee={cell:UICell,covercell:Q,flowcell:J,form:UIForm,row:UIRow,closerow:se,centerrow:re,oppositerow:oe,column:UIColumn,closecolumn:Z,scrollcontainer:UIScrollContainer,button:UIButton,iconbutton:pe,largebutton:he,smallbutton:ue,linkbutton:de,outlinebutton:ce,borderlessbutton:le,primarybutton:ae,label:UILabel,closelabel:ye,expandedlabel:be,p:ve,h1:me,h2:ge,h3:fe,textfield:UITextField,borderlesstextfield:Ie,img:UIImage,toggle:UIToggle,separator:UISeparator,spacer:UISpacer,conditional:UIConditional,formcontext:UIFormContextController,list:UIListController,listcell:UIListCellAdapter,menu:UIMenu,modal:UIModalController,selection:UISelectionController,style:UIStyleController,view:UIViewRenderer,viewcontent:UIViewRenderer.withBoundContent()};function Oe(e,t,...n){n=Me(n);let i,o,r="",s=[];for(let e of n)"string"==typeof e?(r+=e,i=!0):e instanceof Binding?(o||(o=[]),o.push(e),r+="%s"):s.push(e);let a=t?Object.assign({},t):{};if(r&&(o?i||1!==o.length?a.text=new StringFormatBinding(r,...o):a.text=o[0]:a.text=D(r)),"string"==typeof e){let t=Oe.intrinsicTags[e];if(!t)throw Error("[JSX] Invalid tag: "+e);return t.with(a,...s)}return e.prototype instanceof Component?e.with(a,...s):e(a,...s)}function Me(e){let t=[];return e.forEach((e=>{Array.isArray(e)?t.push(...Me(e)):t.push(e)})),t}!function(e){e.intrinsicTags=Ee,e.tag=function(e){function t(){return this instanceof t?new e:e.with.apply(e,arguments)}return t.prototype=e.prototype,t.with=t,t}}(Oe||(Oe={}));let Re=16;const Ae={start:"flex-start",end:"flex-end",center:"center",fill:"space-between","space-around":"space-around","":""},Te={start:"flex-start",end:"flex-end",center:"center",stretch:"stretch",baseline:"baseline","":""};let ke,je,Pe={},Be=[];function De(e){je||(je={});for(let t in e)je[t]=e[t];DOMRenderContext.scheduleRender((()=>{ke||(ke=function(){let e=document.createElement("style");e.setAttribute("type","text/css"),document.head.appendChild(e);let t={};return(n,i)=>{for(let e in n)"@"===e[0]&&t[e]?t[e]=Object.assign(Object.assign({},t[e]),n[e]):t[e]=Object.assign({},n[e]);let o="";for(let e in t)if("@"===e[0]){o+=e+" {\n";for(let n in t[e])o+="  "+n+" { "+Ke(t[e][n])+"}\n";o+="}\n"}else o+=e+" { "+Ke(t[e])+"}\n";e.textContent=i.map((e=>"@import url("+JSON.stringify(e)+");\n"))+".UI { display: block }\n"+o}}()),je&&ke(je,Be),je=void 0}))}function Le(e,t,n,i){if(e.hidden)return t.hidden=!0,void(t.style.cssText="");t.hidden&&(t.hidden=!1);let o=e.style,r={},s="UI";if(UIStyle.isStyleOverride(e.dimensions,o)&&ze(r,e.dimensions),UIStyle.isStyleOverride(e.position,o)&&He(r,e.position),e instanceof UIContainer)UIStyle.isStyleOverride(e.layout,o)&&Ne(r,e.layout),e instanceof UICell&&UIStyle.isStyleOverride(e.decoration,o)&&$e(r,e.decoration),a=r,(l=e)instanceof UICell?($e(a,l),l.textDirection&&(a.direction=l.textDirection),void 0!==l.margin&&(a.margin=Fe(l.margin))):l instanceof UIRow?void 0===l.height||a.height||(a.height=Fe(l.height)):l instanceof UIColumn?void 0===l.width||a.width||(a.width=Fe(l.width)):l instanceof UIScrollContainer&&(void 0!==l.padding&&(a.padding=Fe(l.padding)),l.verticalScrollEnabled&&(a.overflowY="auto"),l.horizontalScrollEnabled&&(a.overflowX="auto"));else if(e instanceof UIControl){UIStyle.isStyleOverride(e.decoration,o)?$e(r,e.decoration):e.decoration.cssClassNames&&(r.className=e.decoration.cssClassNames.join(" ")),UIStyle.isStyleOverride(e.textStyle,o)&&We(r,e.textStyle);let t=+e.dimensions.grow;if((!0===e.shrinkwrap&&t||!1===e.shrinkwrap&&!t)&&(r.flexGrow=e.shrinkwrap?"0":"1"),e instanceof UISeparator){if(r.borderWidth=Fe(e.thickness),e.margin){let t=Fe(e.margin);r.margin=e.vertical?"0 "+t:t+" 0"}e.color&&(r.borderColor=UITheme.replaceColor(e.color))}}var a,l;Pe[o.id]||Ve(o),o.ids.length&&(s+=" "+o.ids.join(" ")),r.className&&(s+=" "+r.className,delete r.className),i&&(s+=" "+i),t.className=s;let c=Ke(r);!c&&n||(t.style.cssText=c)}function Fe(e,t="auto"){if("string"==typeof e)return e;if("number"==typeof e)return e/16+"rem";if("object"==typeof e){let t=0,n=0,i=0,o=0;return e.x&&(i=o=Fe(e.x)),e.y&&(t=n=Fe(e.y)),e.top&&(t=Fe(e.top)),e.bottom&&(n=Fe(e.bottom)),e.start?i=Fe(e.start):e.left&&(i=Fe(e.left)),e.end?o=Fe(e.end):e.right&&(o=Fe(e.right)),t+" "+o+" "+n+" "+i}return t}function Ve(e){Pe[e.id]=!0;let t=e=>{let t={};return e.containerLayout&&Ne(t,e.containerLayout),e.dimensions&&ze(t,e.dimensions),e.position&&He(t,e.position),e.textStyle&&We(t,e.textStyle),e.decoration&&$e(t,e.decoration),t};De({[".UI"+e.ids.map((e=>"."+e)).join("")]:t(e.getOwnStyles())});let n=(n,i)=>{let o=e.conditionalStyles[i];o&&De({[".UI"+e.ids.map((e=>"."+e)).join("")+n]:t(o.getStyles())})};if(n(":focus","focused"),n(":hover:not([disabled])","hover"),n(":active:not([disabled])","pressed"),n("[disabled]","disabled"),n("[data-selected]","selected"),e.inherited.length)for(let t of e.inherited)Pe[t.id]||Ve(t)}function Ne(e,t){let n=t.axis;void 0!==n&&(e.flexDirection="horizontal"===n?"row":"column");let i=t.distribution;void 0!==i&&(e.justifyContent=Ae[i]||"");let o=t.gravity;void 0!==o&&(e.alignItems=Te[o]||"");let r=t.wrapContent;void 0!==r&&(e.flexWrap=r?"wrap":"nowrap");let s=t.clip;void 0!==s&&(e.overflow=s?"hidden":"visible")}function ze(e,t){let n=t.width;void 0!==n&&(e.width=Fe(n));let i=t.height;void 0!==i&&(e.height=Fe(i));let o=t.minWidth;void 0!==o&&(e.minWidth=Fe(o,""));let r=t.minHeight;void 0!==r&&(e.minHeight=Fe(r,""));let s=t.maxWidth;void 0!==s&&(e.maxWidth=Fe(s,""));let a=t.maxHeight;void 0!==a&&(e.maxHeight=Fe(a,""));let l=t.grow;void 0!==l&&(e.flexGrow=l);let c=t.shrink;void 0!==c&&(e.flexShrink=c)}function He(e,t){var n,i,o,r;let s,a,l=t.gravity;void 0===t.left&&void 0===t.right&&void 0===t.start&&void 0===t.end||(s=!0,e.left=Fe(null!==(n=t.left)&&void 0!==n?n:t.start),e.right=Fe(null!==(i=t.right)&&void 0!==i?i:t.end),e.insetInlineStart=Fe(null!==(o=t.start)&&void 0!==o?o:t.left),e.insetInlineEnd=Fe(null!==(r=t.end)&&void 0!==r?r:t.right)),void 0===t.top&&void 0===t.bottom||(a=!0,e.top=Fe(t.top),e.bottom=Fe(t.bottom)),"overlay"===l?(e.position="absolute",e.zIndex="100",s||(e.margin="auto")):(l&&(e.alignSelf=Te[l]),(s||a)&&(e.position="relative"))}function We(e,t){let n=t.direction;void 0!==n&&(e.direction=n);let i=t.align;void 0!==i&&(e.textAlign=i);let o=t.color;void 0!==o&&(e.color=UITheme.replaceColor(o));let r=t.fontFamily;void 0!==r&&(e.fontFamily=r);let s=t.fontSize;void 0!==s&&(e.fontSize=Fe(s,"inherit"));let a=t.fontWeight;void 0!==a&&(e.fontWeight=String(a));let l=t.letterSpacing;void 0!==l&&(e.letterSpacing=Fe(l));let c=t.lineHeight;void 0!==c&&(e.lineHeight=String(c));let d=t.lineBreakMode;"clip"===d?(e.overflow="hidden",e.textOverflow="clip"):"ellipsis"===d?(e.overflow="hidden",e.textOverflow="ellipsis"):void 0!==d&&(e.whiteSpace=d),t.bold&&(e.fontWeight="bold");let h=t.italic;void 0!==h&&(e.fontStyle=h?"italic":"normal");let u=t.uppercase;void 0!==u&&(e.textTransform=u?"uppercase":"none");let p=t.smallCaps;void 0!==p&&(e.fontVariant=p?"small-caps":"normal");let m=t.underline,g=t.strikeThrough;m?e.textDecoration="underline"+(g?" line-through":""):g?e.textDecoration="line-through":!1!==m&&!1!==g||(e.textDecoration="none")}function $e(e,t){let n=t.background;void 0!==n&&(e.background=UITheme.replaceColor(n));let i=t.textColor;void 0!==i&&(e.color=UITheme.replaceColor(i));let o=t.borderThickness;void 0!==o&&(e.borderWidth=Fe(o));let r=t.borderColor;null!=r&&(e.borderColor=UITheme.replaceColor(r)),null!=t.borderStyle&&(e.borderStyle=t.borderStyle),void 0!==t.borderRadius&&(e.borderRadius=Fe(t.borderRadius));let s=t.padding;if(void 0!==s&&(e.padding=Fe(s)),void 0!==t.dropShadow&&(e.boxShadow=function(e=0){let t="";return e<0&&(t="inset ",e=-e),(e=Math.min(1,Math.max(0,e)))>0?`${t}0 0 ${2*e}rem ${-.25*e}rem rgba(0,0,0,${e*e*.3}),${t}0 ${.85*e}rem ${1*e}rem ${-.25*e}rem rgba(0,0,0,${.15*e+.1}),${t}0 ${e*e*.5+.6*e}rem ${1*e}rem ${-1*e}rem rgba(0,0,0,.4),${t}0 ${e*e*1.5}rem ${3*e}rem ${-1*e}rem rgba(0,0,0,.3),${t}0 ${e*e*3}rem ${2.5*e}rem ${-2*e}rem rgba(0,0,0,.3)`:"none"}(t.dropShadow)),t.opacity>=0&&(e.opacity=String(t.opacity)),t.css)for(let n in t.css)e[n]=t.css[n];t.cssClassNames&&(e.className=t.cssClassNames.join(" "))}function Ke(e){let t="";for(let o in e){if("className"===o||""===e[o]||null==e[o])continue;let r=(i=void 0,null!==(i=qe[n=o])&&void 0!==i?i:qe[n]=n.replace(/([A-Z])/g,"-$1").toLowerCase().replace(/^(webkit|o|ms|moz)-/,"-$1-")),s=String(e[o]);s.indexOf("|")>=0?s.split("||").reverse().forEach((e=>{t+=r+": "+e+"; "})):t+=r+": "+s+"; "}var n,i;return t}const qe=Object.create(null);class DOMViewportContext extends ManagedObject{constructor(){super(...arguments),this.narrow=!1,this.wide=!1,this.short=!1,this.tall=!1,this._smallBreakpoint=590,this._largeBreakpoint=1150}setBreakpoints(e,t){this._smallBreakpoint=e,this._largeBreakpoint=t,this.update()}update(){let e=!1,t=window.innerWidth/Re*16,n=window.innerHeight/Re*16,i=t<this._smallBreakpoint,o=t>this._largeBreakpoint,r=n<this._smallBreakpoint,s=n>this._largeBreakpoint;return this.width=t,this.height=n,this.narrow!==i&&(this.narrow=i,e=!0),this.wide!==o&&(this.wide=o,e=!0),this.short!==r&&(this.short=r,e=!0),this.tall!==s&&(this.tall=s,e=!0),e&&this.emitChange(),!1}}const Ge=(window.DOM_UI_RENDER_MODULE_ID=(window.DOM_UI_RENDER_MODULE_ID||1e3)+1)+Math.floor(1e6*Math.random())+"_RendererBase";let Ye,Xe;function Je(e){let t=this.lastChild;t&&e.target&&e.target!==t&&(t.compareDocumentPosition(e.target)&Node.DOCUMENT_POSITION_CONTAINED_BY||(e.preventDefault(),setTimeout((()=>{let e=document.createElement("div");e.tabIndex=-1,t.insertBefore(e,t.firstChild),e.focus(),t.removeChild(e)}),0)))}const Qe=["click","dblclick","contextmenu","mouseup","mousedown","keydown","keypress","keyup","focusin","focusout","touchstart","touchend"];function Ze(e){let t=e.target;for(;t&&t!==this;){let n=t[Ge];if(n&&n.DOM_EMIT)return n.DOM_EMIT.call(n,e);t=t.parentNode}}const et=["change","input","copy","cut","paste"];function tt(e){let t=e.target,n=t[Ge]||t.parentNode&&t.parentNode[Ge];if(n&&n.DOM_CONTROL_EMIT)return n.DOM_CONTROL_EMIT.call(n,e)}const nt=["mouseenter","mouseleave","submit"];function it(e){let t=e.target;for(;t&&t!==this;){let n=t[Ge];if(n&&n.DOM_CELL_EMIT)return n.DOM_CELL_EMIT.call(n,e);t=t.parentNode}}class DOMRenderContext extends UIRenderContext{constructor(e,t){super(),this.viewportContext=new DOMViewportContext,this._updateViewportContext=()=>this.viewportContext.update(),e?(this.root=e,this._removeOnDestroy=!!t):(this.root=DOMRenderContext.createFixedRootElement(),this._removeOnDestroy=!0),this.addEventListeners(),this.viewportContext.update()}static scheduleRender(e,t){if(t&&!Xe&&(Xe=[]),!Ye){Ye=[];const e=()=>{let e=Date.now();for(;Ye&&Ye.length||Xe;){for(;Ye&&Ye.length;)if(Ye.shift()(),Date.now()-e>30)return void setTimeout(t,10);if(Xe){let e=Xe.shift();Xe.length||(Xe=void 0),Ye=[e]}}Ye=void 0},t=()=>{if("function"==typeof window.requestAnimationFrame){let t=0;const n=()=>{t||e(t=1)};window.requestAnimationFrame(n),setTimeout(n,200)}else setTimeout(e,10)};t()}return new Promise(((n,i)=>{(t?Xe:Ye).push((()=>{try{n(e())}catch(e){i(e)}}))}))}static createFixedRootElement(){let e=document.createElement("app");return e.className="App__FixedRoot",e.style.opacity="0",setTimeout((()=>{e.style.background=UITheme.replaceColor("@appBackground"),e.style.color=UITheme.replaceColor("@text"),e.style.opacity="1"}),0),document.body.appendChild(e),e}addEventListeners(){window.addEventListener("resize",this._updateViewportContext),this._updateViewportTimer=setInterval(this._updateViewportContext,500),this.root.removeEventListener("focusin",Je,!0),this.root.addEventListener("focusin",Je,!0);for(let e of Qe)this.root.removeEventListener(e,Ze),this.root.addEventListener(e,Ze);for(let e of et)this.root.removeEventListener(e,tt),this.root.addEventListener(e,tt);for(let e of nt)this.root.removeEventListener(e,it,!0),this.root.addEventListener(e,it,!0)}clear(){this.root.innerHTML=""}onManagedStateDestroyingAsync(){const e=Object.create(null,{onManagedStateDestroyingAsync:{get:()=>super.onManagedStateDestroyingAsync}});return n(this,void 0,void 0,(function*(){yield e.onManagedStateDestroyingAsync.call(this),window.removeEventListener("resize",this._updateViewportContext),clearInterval(this._updateViewportTimer),this.clear(),this._removeOnDestroy&&this.root.parentNode&&this.root.parentNode.removeChild(this.root)}))}getRenderCallback(){let t=(n,i)=>n?n.placement===e.UIRenderPlacement.PAGE?this._placePage(n,i):this._placeModal(n,i):t;return t}_placePage(t,n){let i=e=>{if(!this.managedState)return;if(e.detach&&e.detach(),this._page){let t=this._page.element.nextSibling;this.root.insertBefore(e.element,t),this._page.element!==e.element&&this._rm(this._page.element)}else this.root.insertBefore(e.element,this.root.firstChild);this._page=e;let t=e.source.getParentComponent(AppActivity);for(;t;){let e=t.navigationTarget&&String(t.navigationTarget.title||"")||t.name||"";if(e){document.title=e;break}t=t.getParentActivity()}},o=t;DOMRenderContext.scheduleRender((()=>(this._page!==t&&i(t),t))).then(n).catch(M);let r=(t,n)=>t&&t.placement!==e.UIRenderPlacement.PAGE?(o&&this._rm(o.element),this._placeModal(t,n)):(DOMRenderContext.scheduleRender((()=>{if(this.managedState)return this._page===o&&(t?(i(t),o=t):(o&&this._rm(o.element),o=this._page=void 0)),t})).then(n).catch(M),t?r:this.getRenderCallback());return r}_placeModal(t,n){let i=document.createElement("div");i.className="App__ModalShader",i.tabIndex=0,BrowserApplication.transitionsDisabled&&(i.style.transition="none"),i.addEventListener("click",(e=>{e.target!==i&&e.target!==o||(e.stopPropagation(),t.source instanceof UIComponent&&DOMRenderContext.$touchData.last<Date.now()-1e3&&t.source.emitAction("CloseModal"))}),!0),i.addEventListener("touchend",(e=>{e.target!==i&&e.target!==o||(e.stopPropagation(),t.source instanceof UIComponent&&(DOMRenderContext.$touchData.last=Date.now(),t.source.emitAction("CloseModal")))}),!0),i.addEventListener("keydown",(e=>{27===e.keyCode?(e.stopPropagation(),t.source instanceof UIComponent&&(t.source.emit(UIComponentEvent,"EscapeKeyPress",t.source,void 0,e),t.source.emitAction("CloseModal"))):t.source instanceof UIComponent&&(37===e.keyCode?t.source.emit(UIComponentEvent,"ArrowLeftKeyPress",t.source,void 0,e):38===e.keyCode?t.source.emit(UIComponentEvent,"ArrowUpKeyPress",t.source,void 0,e):39===e.keyCode?t.source.emit(UIComponentEvent,"ArrowRightKeyPress",t.source,void 0,e):40===e.keyCode&&t.source.emit(UIComponentEvent,"ArrowDownKeyPress",t.source,void 0,e))}),!0);let o=document.createElement("div");o.className="App__ModalWrapper",o.setAttribute("aria-modal","true"),i.appendChild(o);let r=document.activeElement;DOMRenderContext.scheduleRender((()=>{if(this.managedState)return this._addModalContent(o,t),this.root.appendChild(i),setTimeout(e,0),setTimeout(e,10),setTimeout(e,100),setTimeout((()=>{i.dataset.transitionT="revealed"}),0),t;function e(){document.activeElement&&i.compareDocumentPosition(document.activeElement)&Node.DOCUMENT_POSITION_CONTAINED_BY||i.focus()}})).then(n).catch(M);let s=(t,n)=>t&&t.placement===e.UIRenderPlacement.PAGE?(this._rm(i),this._placePage(t,n)):(DOMRenderContext.scheduleRender((()=>{if(this.managedState){if(t)this._addModalContent(o,t);else if(i.style.background="",st(i,o.firstChild),r)try{r.focus()}catch(e){}return t}})).then(n).catch(M),t?s:this.getRenderCallback());return s}_addModalContent(t,n){let i=t.firstChild;for(;i;)i.dataset&&i.dataset.uiRemoved||t.removeChild(i),i=i.nextSibling;setTimeout((()=>{let e=100*(n.modalShadeOpacity||0)+"%",i=UITheme.replaceColor("@modalShade/"+e),o=t.parentNode;o&&(o.style.backgroundColor=i)}),0),n.detach&&n.detach(),t.appendChild(n.element),t.style.cssText="";let o=n.placementRef&&n.placementRef.lastRenderOutput,r=o&&o.element,s=r&&r.getBoundingClientRect&&r.getBoundingClientRect();switch(n.placement){case e.UIRenderPlacement.DROPDOWN:case e.UIRenderPlacement.DROPDOWN_COVER:if(t.style.position="absolute",!s)break;t.style.top=n.placement===e.UIRenderPlacement.DROPDOWN?s.bottom+"px":s.top+"px",t.style.left=s.left+"px",t.style.width=s.width+"px",t.style.flexDirection="column",t.style.opacity="0",setTimeout((()=>{ot(t,s.top)}),0);break;case e.UIRenderPlacement.POPOVER:if(t.style.position="absolute",!s)break;let i=(s.left+s.right)/2;t.style.top=s.bottom+8+"px",t.style.left=i-70+"px",t.style.width="140px",t.style.flexDirection="column",t.style.opacity="0",setTimeout((()=>{ot(t)}),0);break;case e.UIRenderPlacement.POPOVER_ABOVE:if(t.style.position="relative",!s)break;let o=(s.left+s.right)/2;t.style.top=s.top-8+"px",t.style.height="0px",t.style.left=o-70+"px",t.style.width="140px",t.style.flexDirection="column",t.style.justifyContent="flex-end",t.style.flexGrow="0",t.style.opacity="0",setTimeout((()=>{ot(t)}),0);break;case e.UIRenderPlacement.POPOVER_LEFT:if(t.style.position="absolute",!s)break;let r=(s.top+s.bottom)/2;t.style.top=r-16+"px",t.style.height="32px",t.style.left=s.left-8+"px",t.style.width="0px",t.style.flexDirection="row",t.style.alignItems="center",t.style.justifyContent="flex-end",t.style.opacity="0",setTimeout((()=>{rt(t)}),0);break;case e.UIRenderPlacement.POPOVER_RIGHT:if(t.style.position="absolute",!s)break;let a=(s.top+s.bottom)/2;t.style.top=a-16+"px",t.style.height="32px",t.style.left=s.right+8+"px",t.style.width="0px",t.style.flexDirection="row",t.style.alignItems="center",t.style.justifyContent="flex-start",t.style.opacity="0",setTimeout((()=>{rt(t)}),0);break;case e.UIRenderPlacement.DRAWER:t.style.flexDirection="column",t.style.alignItems="start",t.style.justifyContent="space-around";break;case e.UIRenderPlacement.DIALOG:t.style.flexDirection="row",t.style.alignItems="center",t.style.justifyContent="space-around";break;default:t.style.flexDirection="column",t.style.alignItems="stretch",t.style.justifyContent="stretch"}}_rm(e){e&&e.parentNode===this.root&&this.root.removeChild(e)}}function ot(e,t=-1){let n=e.firstChild;if(n&&n.dataset&&"revealing"===n.dataset.transitionT){e.style.opacity="";let i=()=>{n.removeEventListener("animationend",i),n.removeEventListener("animationcancel",i),n.removeEventListener("transitionend",i),n.removeEventListener("transitioncancel",i),ot(e,t)};return n.addEventListener("animationend",i),n.addEventListener("animationcancel",i),n.addEventListener("transitionend",i),n.addEventListener("transitioncancel",i),void setTimeout((()=>{DOMRenderContext.scheduleRender(i)}),1e3)}let i=(n||e).getBoundingClientRect();i.left<0?(e.style.left="0px",e.style.width=i.width>window.innerWidth?i.width+"px":"auto"):i.right>window.innerWidth&&(e.style.left=Math.max(0,window.innerWidth-i.width)+"px",e.style.width=i.width+"px"),i.top<0?(e.style.top="0px",e.style.bottom="",e.style.justifyContent="flex-start"):i.bottom>window.innerHeight&&(t>0&&i.height<t?(e.style.top=t+"px",e.style.height="0px",e.style.justifyContent="flex-end"):i.height<window.innerHeight?(e.style.bottom="0px",e.style.top="",e.style.justifyContent="flex-end"):(e.style.top="0px",e.style.bottom="",e.style.justifyContent="flex-start")),e.style.opacity=""}function rt(e){let t=e.firstChild;if(t&&t.dataset&&"revealing"===t.dataset.transitionT){e.style.opacity="";let n=()=>{t.removeEventListener("animationend",n),t.removeEventListener("animationcancel",n),t.removeEventListener("transitionend",n),t.removeEventListener("transitioncancel",n),rt(e)};return t.addEventListener("animationend",n),t.addEventListener("animationcancel",n),t.addEventListener("transitionend",n),t.addEventListener("transitioncancel",n),void setTimeout((()=>{DOMRenderContext.scheduleRender(n)}),1e3)}let n=(t||e).getBoundingClientRect();n.left<0?(e.style.left="0px",e.style.width=n.width>window.innerWidth?n.width+"px":"auto",e.style.justifyContent="flex-start"):n.right>window.innerWidth&&(e.style.left=Math.max(0,window.innerWidth-n.width)+"px",e.style.width=n.width+"px",e.style.justifyContent="flex-end"),n.top<0?(e.style.top="0px",e.style.bottom="",e.style.height=n.height+"px"):n.bottom>window.innerHeight&&(e.style.top=Math.max(0,window.innerHeight-n.height)+"px",e.style.bottom="",e.style.height=n.height+"px"),e.style.opacity=""}function st(e,...t){let n=e.parentNode;if(!n)return;e.dataset.uiRemoved="removed";let i,o=0;function r(){this&&this.removeEventListener("animationend",r),this&&this.removeEventListener("animationcancel",r),this&&this.removeEventListener("transitionend",r),this&&this.removeEventListener("transitioncancel",r),this!==e&&--o>0||(e.parentNode===n&&n.removeChild(e),i&&clearTimeout(i))}function s(e){e&&e.dataset.transitionExit&&(e.addEventListener("animationend",r),e.addEventListener("animationcancel",r),e.addEventListener("transitionend",r),e.addEventListener("transitioncancel",r),e.dataset.transitionT="exiting",o++)}s(e),t.forEach(s),o?i=setTimeout((()=>{o=0,r()}),2e3):Promise.resolve().then((()=>r()))}function at(e,t,n){var i;if(e.hot){e.hot.accept();let o=null===(i=e.hot.data)||void 0===i?void 0:i.autoUpdate;setTimeout((()=>{o&&t[n]&&t[n](o,t)}),0),t[n]&&e.hot.dispose((n=>{(n||e.hot.data).autoUpdate=t}))}}DOMRenderContext.$touchData={last:0},t([U],DOMRenderContext.prototype,"viewportContext",void 0),e.HMR=void 0,(e.HMR||(e.HMR={})).enableViewReload=function(e,t){return t};class BrowserHashActivationContext extends AppActivationContext{constructor(){super(),this._handler=()=>{this._setPath()},window.addEventListener("hashchange",this._handler),this._setPath()}getPathHref(e){let t="";if(!e||":"===e[0])return"";if("#"===e[0]&&(e=e.slice(1)),"/"===e[0])t=e;else{let n=this.target;"/"!==n.slice(-1)&&(n+="/"),t="/"+n+e}t=t.replace(/\/+/g,"/");let n=0;for(;/\/\.\.?\//.test(t)&&!(n++>100);)t=t.replace(/\/\.\//g,"/").replace(/\/[^\/]+\/\.\.\//g,"/").replace(/^\/?\.\.\//,"/");return"#/"+t.replace(/^\/+/,"")}navigate(e,t){e=String(e),t&&t.back?(window.history.back(),e&&setTimeout((()=>this.navigate(e,Object.assign(Object.assign({},t),{back:!1}))),1)):":back"===e?window.history.back():t&&t.replace&&"function"==typeof window.history.replaceState?e&&(window.history.replaceState({},document.title,this.getPathHref(e)),this._setPath()):e&&(window.location.hash=this.getPathHref(e))}onManagedStateDestroyingAsync(){return n(this,void 0,void 0,(function*(){window.removeEventListener("hashchange",this._handler)}))}_setPath(){let e=String(window.location.hash||"").replace(/^\#\/?/,"");this.target=e}}class BrowserHistoryActivationContext extends AppActivationContext{constructor(){super(),this._handler=()=>{this._setPath()},window.addEventListener("popstate",this._handler),this._setPath()}getPathHref(e){let t="";if(!e||":"===e[0])return"";if("#"===e[0]&&(e=e.slice(1)),"/"===e[0])t=e;else{let n=this.target;"/"!==n.slice(-1)&&(n+="/"),t="/"+n+e}t=t.replace(/\/+/g,"/");let n=0;for(;/\/\.\.?\//.test(t)&&!(n++>100);)t=t.replace(/\/\.\//g,"/").replace(/\/[^\/]+\/\.\.\//g,"/").replace(/^\/?\.\.\//,"/");return"/"+t.replace(/^\/+/,"")}navigate(e,t){t&&t.back?(window.history.back(),e&&setTimeout((()=>this.navigate(e,Object.assign(Object.assign({},t),{back:!1}))),1)):":back"===e?window.history.back():t&&t.replace&&"function"==typeof window.history.replaceState?(e&&window.history.replaceState({},document.title,this.getPathHref(e)),this._setPath()):(e&&window.history.pushState({},document.title,this.getPathHref(e)),this._setPath())}onManagedStateDestroyingAsync(){return n(this,void 0,void 0,(function*(){window.removeEventListener("popstate",this._handler)}))}_setPath(){let e=String(window.location.pathname||"").replace(/^\/?/,"");this.target=e}}let lt=!1;Application.setAutoUpdateHandler(at);class BrowserApplication extends Application{constructor(e){super(),this._root=e}static setGlobalDpSize(e=1){!function(e){Re=16*e,De({html:{fontSize:Re+"px"}})}(e)}static importStylesheet(e){!function(e){Be.push(e),De({})}(e)}static disableTransitions(){lt=!0}static get transitionsDisabled(){return lt}onManagedStateActivatingAsync(){const e=Object.create(null,{onManagedStateActivatingAsync:{get:()=>super.onManagedStateActivatingAsync}});return n(this,void 0,void 0,(function*(){yield e.onManagedStateActivatingAsync.call(this),this.renderContext||(this._root||(document.body.innerHTML=""),this.renderContext=new DOMRenderContext(this._root)),this.activationContext||(this.activationContext=this._useHistoryAPI?new BrowserHistoryActivationContext:new BrowserHashActivationContext)}))}onManagedStateInactiveAsync(){const e=Object.create(null,{onManagedStateInactiveAsync:{get:()=>super.onManagedStateInactiveAsync}});return n(this,void 0,void 0,(function*(){yield e.onManagedStateInactiveAsync.call(this),this.renderContext=void 0,this.activationContext=void 0}))}mount(e,t){return this._root=e,this.renderContext&&(this.renderContext=new DOMRenderContext(e,t)),this}unmount(){return this._root=void 0,this.renderContext=void 0,this}useHistoryAPI(){return this._useHistoryAPI=!0,this.activationContext&&(this.activationContext=new BrowserHistoryActivationContext),this}}BrowserApplication.addObserver(class{onRenderContextChange(){Pe={}}});const ct=UIStyle.group({alertDialog:{decoration:{background:"@background",borderRadius:4,dropShadow:.65},position:{gravity:"center"},dimensions:{maxWidth:400,width:"95vw"}},"alertDialog-titlebar":{decoration:{background:"@primary",textColor:"@primary.text"},dimensions:{height:40}},"alertDialog-title":{},"alertDialog-buttonRow":{containerLayout:{distribution:"end"},decoration:{padding:0}},"alertDialog-cancelButton":{dimensions:{grow:0}},"alertDialog-confirmButton":{dimensions:{grow:0}}});class AlertDialog extends(ViewComponent.with({defaults:()=>({messages:[],title:void 0,confirmButtonLabel:D("Dismiss"),cancelButtonLabel:void 0}),view:UICell.with({style:"alertDialog",revealTransition:"up-fast"},J.with({style:"alertDialog-titlebar",hidden:F("title|!"),onMouseDown:"+DragContainer"},se.with(UISpacer.withWidth(16),be.withText(F("title"),"alertDialog-title"),le.with({position:{gravity:"center"},icon:"close",onClick:"+CloseModal",iconSize:18,iconColor:"currentColor",textStyle:{color:"inherit"},disableKeyboardFocus:!0}))),UICell.with({padding:16},Z.with({content:F("messageLabels",[])}),UISpacer.withHeight(24),UIRow.with({style:"alertDialog-buttonRow"},de.with({style:"alertDialog-cancelButton",shrinkwrap:"auto",hidden:F("cancelButtonLabel|!"),label:F("cancelButtonLabel"),onClick:"+CloseModal"}),ae.with({style:"alertDialog-confirmButton",shrinkwrap:"auto",label:F("confirmButtonLabel"),onClick:"+Confirm",requestFocus:!0}))))})){beforeRender(){let e=[];for(let t of this.messages)e.push(new ve(t));this.messageLabels=e}}class AlertDialogBuilder extends ConfirmationDialogBuilder{constructor(){super(...arguments),this._presets={messages:[]}}build(){return AlertDialog.with(this._presets)}setTitle(e){return this._presets.title=e,this}setConfirmButtonLabel(e){return this._presets.confirmButtonLabel=e,this}setCancelButtonLabel(e){return this._presets.cancelButtonLabel=e,this}addMessage(e){return this._presets.messages.push(e),this}}const dt=UIStyle.group({dropdownMenu:{dimensions:{minWidth:50,maxWidth:280},decoration:{background:"@background",borderRadius:4,dropShadow:.8}},"dropdownMenu-item":UIStyle.create({containerLayout:{axis:"horizontal"},decoration:{padding:{x:16},css:{cursor:"pointer"}}}).addState("hover",{decoration:{background:"@primary",textColor:"@primary.text"}}).addState("focused",{decoration:{background:"@primary",textColor:"@primary.text"}}),"dropdownMenu-label":{},"dropdownMenu-hint":{textStyle:{color:"@text/50%",fontSize:12}}});class DropdownMenu extends(UICell.with({style:"dropdownMenu",onArrowDownKeyPress(e){if(e.source instanceof DropdownMenu)for(let e of this.content)if(e instanceof UICell)return void e.requestFocus()}})){emitMenuItemSelectedEvent(e){this.emit(UIMenuItemSelectedEvent,"SelectMenuItem",this,e)}}class DropdownMenuBuilder extends UIMenuBuilder{constructor(){super(...arguments),this._items=[],this._gravity="end"}clear(){return this._items.length=0,this}addOption(e,t,n,i,o,r,s){function a(){let t=this.getParentComponent(DropdownMenu);t&&t.emitMenuItemSelectedEvent(e),this.emitAction("CloseModal")}return this._items.push(UICell.with({style:"dropdownMenu-item",allowKeyboardFocus:!0,onClick:a,onEnterKeyPress:a,onArrowDownKeyPress:function(){this.requestFocusNext()},onArrowUpKeyPress:function(){this.requestFocusPrevious()}},be.with({text:t,icon:n,iconMargin:8,style:"dropdownMenu-label",textStyle:r}),i?UISpacer.withWidth(8):void 0,i?UILabel.with({text:i,icon:o,style:"dropdownMenu-hint",textStyle:s}):void 0)),this}addSelectionGroup(e,t,n){for(let i of e)this.addOption(i.key,i.text,i.key===t?"check":"blank",void 0,void 0,n);return this}addSeparator(){return this._items.push(UISeparator.with({margin:8})),this}setGravity(e){return this._gravity=e,this}setRevealTransition(e){return this._revealTransition=e,this}setExitTransition(e){return this._exitTransition=e,this}build(){return DropdownMenu.with({position:{gravity:this._gravity},revealTransition:this._revealTransition,exitTransition:this._exitTransition,content:[new UISpacer(8,8),...this._items.map((e=>new e)),new UISpacer(8,8)]})}}class BrowserTheme extends UITheme{constructor(){super(),this.ConfirmationDialogBuilder=AlertDialogBuilder,this.MenuBuilder=DropdownMenuBuilder,this.icons={blank:'<svg viewBox="0 0 48 48"></svg>',close:'<svg viewBox="0 0 48 48"><path d="M39 12l-3-3l-12 12l-12-12l-3 3l12 12l-12 12l3 3l12-12l12 12l3-3l-12-12l12-12z"/></svg>',expandDown:'<svg viewBox="0 0 48 48"><path d="M32 18l-9 9l-9-9l-3 3l12 12l12-12l-3-3"/></svg>',menu:'<svg viewBox="0 0 48 48"><path d="M6 36h36v-4H6v4zm0-10h36v-4H6v4zm0-14v4h36v-4H6z"/></svg>',check:'<svg viewBox="0 0 48 48"><path d="M18 32L10 24l-3 3L18 38l24-24-3-3z"/></svg>'},this.colors=Object.assign(Object.assign({},this.colors),{black:"#000000",darkerGray:"#333333",darkGray:"#777777",lightGray:"#dddddd",white:"#ffffff",slate:"#667788",lightSlate:"#c0c8d0",red:"#ee3333",orange:"#ee9922",yellow:"#ddcc33",lime:"#99bb33",green:"#44aa44",turquoise:"#33aaaa",cyan:"#33bbbb",blue:"#3355aa",violet:"#5533aa",purple:"#8833aa",magenta:"#dd4488",primary:"@blue",accent:"@purple",appBackground:"@background"}),this.styles=UIStyle.group(this.styles,ct,dt,{container:{decoration:{css:{display:"flex",textAlign:"start||left"}}},control:{textStyle:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, "Helvetica Neue", Arial, sans-serif',fontSize:14,fontWeight:"normal",lineHeight:"normal",italic:!1,lineBreakMode:"pre"}},spacer:{dimensions:{grow:1,width:8,height:8},position:{gravity:"stretch"}},separator:{dimensions:{grow:0,shrink:0},position:{gravity:"stretch"}},label:{dimensions:{maxWidth:"100%"},decoration:{css:{margin:"calc(1rem - .5em) 0"}},textStyle:{lineBreakMode:"ellipsis"}},label_close:{decoration:{css:{margin:"0"}}},heading1:{textStyle:{fontSize:60,fontWeight:200,letterSpacing:-.5}},heading2:{textStyle:{fontSize:24}},heading3:{textStyle:{fontSize:18,bold:!0}},paragraph:{textStyle:{lineBreakMode:"pre-wrap",lineHeight:1.4},decoration:{css:{cursor:"text"}}},button:UIStyle.create({dimensions:{minWidth:96},textStyle:{align:"center",lineBreakMode:"ellipsis"},decoration:{borderThickness:0,background:"@controlBase",textColor:"@primary",borderRadius:4,padding:{y:8,x:12},css:{cursor:"pointer",transition:"all .2s ease"}}}).addState("pressed",{decoration:{background:"@primary",textColor:"@primary:text"}}).addState("hover",{decoration:{background:"@primary",textColor:"@primary:text"}}).addState("disabled",{decoration:{borderThickness:0,background:"@controlBase",textColor:"@primary",css:{opacity:".5",cursor:"inherit"}}}),button_primary:UIStyle.create({decoration:{background:"@primary",textColor:"@primary:text",borderThickness:1,borderColor:"@primary"}}).addState("hover",{decoration:{background:"@primary^+30%",borderThickness:1,borderColor:"@primary^+30%"}}),button_borderless:UIStyle.create({dimensions:{minWidth:16,minHeight:16},decoration:{background:"transparent",borderThickness:1,borderColor:"transparent",padding:{y:6,x:12}}}).addState("hover",{decoration:{background:"@controlBase^-50%/30%",textColor:"@primary"}}),button_outline:UIStyle.create({decoration:{borderThickness:1,borderColor:"@primary"}}),button_link:UIStyle.create({dimensions:{minWidth:16,minHeight:16},textStyle:{align:"start||left"},decoration:{background:"transparent"}}).addState("hover",{textStyle:{underline:!0},decoration:{background:"transparent",textColor:"@primary"}}).addState("disabled",{decoration:{background:"transparent",textColor:"@primary"}}),button_large:UIStyle.create({dimensions:{minWidth:128},textStyle:{fontWeight:200,fontSize:16},decoration:{background:"@primary",textColor:"@primary:text",borderRadius:32,padding:{y:12,x:16}}}),button_small:UIStyle.create({dimensions:{minWidth:64},textStyle:{fontSize:12},decoration:{borderThickness:1,borderColor:"@controlBase^-20%",padding:{y:4,x:8}}}),button_icon:UIStyle.create({dimensions:{minWidth:32,minHeight:32},position:{gravity:"center"},decoration:{background:"transparent",borderRadius:"50%",padding:0}}).addState("hover",{decoration:{background:"@decoration^-50%/30%",textColor:"@primary"}}),textfield:UIStyle.create({decoration:{background:"@white",textColor:"@white:text",borderColor:"@controlBase^-20%",borderThickness:1,borderRadius:4,padding:8,css:{cursor:"text"}},textStyle:{lineBreakMode:"pre-wrap"}}),textfield_borderless:UIStyle.create({decoration:{background:"transparent",borderThickness:0,borderRadius:0,padding:0}}).addState("focused",{decoration:{css:{boxShadow:"none"}}}),toggle:{decoration:{textColor:"@text",cssClassNames:["UI__CustomToggle"]}},image:{position:{gravity:"center"}}})}setFocusOutline(e=2,t=0,n="@primary/50%"){let i="0 0 "+Fe(t)+" "+Fe(e)+" "+UITheme.replaceColor(n);return De({".UI[tabindex]:focus":{boxShadow:i},".UI.ShowFocusWithin[tabindex]:focus-within":{boxShadow:i},".UI>[tabindex]:focus+label>control":{boxShadow:i}}),this}}function ht(e,t,n,i){let o="";t&&(o="opacity "+t),n&&(o+=(o?", ":"")+"transform "+n),De({[`[data-transition-reveal=${e}][data-transition-t=revealing]`]:{opacity:i[0][0],transform:i[0][1]},[`[data-transition-reveal=${e}][data-transition-t=revealed]`]:{opacity:i[1][0],transform:i[1][1],transition:o},[`[data-transition-exit=${e}][data-transition-t=exiting]`]:{opacity:(i[2]||i[0])[0],transform:(i[2]||i[0])[1],transition:o}})}!function(){De({".UI":{margin:"0",padding:"0",border:"0 solid transparent",outline:"0",cursor:"inherit",boxSizing:"border-box",textOverflow:"ellipsis",textDecoration:"none"},".UI[hidden]":{display:"none !important"},".App__FixedRoot":{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",display:"flex",flexDirection:"column",cursor:"default",overflow:"hidden"},".App__ModalShader":{zIndex:"1000",position:"fixed",top:"0",left:"0",bottom:"0",right:"0",outline:"0",overflow:"auto",display:"flex",flexDirection:"column",justifyContent:"stretch",alignContent:"stretch",transition:"background-color .2s ease-in-out",background:"transparent"},".App__ModalWrapper":{flex:"1 0 auto",display:"flex"},".App__ModalWrapper>.UI":{zIndex:"10000",overflow:"hidden"},".UIRender__Separator--line":{flex:"0 0 auto",margin:"0",padding:"0",border:"0",borderTopStyle:"solid",borderWidth:"1px",alignSelf:"stretch"},".UIRender__Separator--line-vertical":{borderTopStyle:"none",borderLeftStyle:"solid",borderWidth:"1px"},".UIRender__Separator--spacer":{flex:"0 0 auto",width:"1px",height:"1px",alignSelf:"center"},".UI__CustomToggle":{lineHeight:"1.5rem",position:"relative",padding:".25rem 0"},".UI__CustomToggle>input":{position:"absolute",top:".25rem",left:"0",width:"1rem",height:"1rem",margin:"0",padding:"0",border:"0",opacity:"0"},".UI__CustomToggle>input+label":{display:"inline-block",paddingLeft:"1rem"},".UI__CustomToggle>input[disabled]+label":{opacity:".5"},".UI__CustomToggle>input:not([disabled])+label":{cursor:"pointer"},".UI__CustomToggle>input+label>control":{content:"''",position:"absolute",top:".25rem",left:"0",width:".875rem",height:".875rem",background:"#fff",border:"1px solid #aaa",borderRadius:".25rem"},".UI__CustomToggle>input:checked+label>control":{borderColor:"#666",background:"#666"},".UI__CustomToggle>input:checked+label>control::after":{content:"''",boxSizing:"border-box",display:"block",position:"absolute",top:"0",left:".25rem",height:".75rem",width:".375rem",transform:"rotate(45deg)",borderBottom:".125rem solid #fff",borderRight:".125rem solid #fff"},"a.UI":{display:"flex",flexDirection:"column",justifyContent:"center"}});const e=[1],t=[0,"translateY(-50%)"],n=[0,"translateY(50%)"],i=[0,"translateX(-50%)"],o=[0,"translateX(50%)"];ht("fade",".5s ease-in-out","",[[0],e]),ht("fade-fast",".2s ease-in-out","",[[0],e]),ht("down",".5s ease-in-out",".5s ease",[t,e,n]),ht("down-fast",".2s ease-in-out",".15s ease",[t,e,n]),ht("up",".5s ease-in-out",".5s ease",[n,e,t]),ht("up-fast",".2s ease-in-out",".15s ease",[n,e,t]),ht("left",".5s ease-in-out",".5s ease",[o,e,i]),ht("left-fast",".2s ease-in-out",".15s ease",[o,e,i]),ht("right",".5s ease-in-out",".5s ease",[i,e,o]),ht("right-fast",".2s ease-in-out",".15s ease",[i,e,o])}(),function(){let e=new BrowserTheme;UITheme.current=e,e.setFocusOutline()}();const ut=new ManagedEvent("Rendered").freeze(),pt={click:"Click",dblclick:"DoubleClick",contextmenu:"ContextMenu",mouseup:"MouseUp",mousedown:"MouseDown",mouseenter:"MouseEnter",mouseleave:"MouseLeave",touchstart:"TouchStart",touchend:"TouchEnd",keydown:"KeyDown",keyup:"KeyUp",keypress:"KeyPress",focusin:"FocusIn",focusout:"FocusOut",change:"Change",input:"Input",copy:"Copy",cut:"Cut",paste:"Paste",submit:"Submit"},mt={Enter:"EnterKey",Spacebar:"Spacebar"," ":"Spacebar",Backspace:"BackspaceKey",Delete:"DeleteKey",Del:"DeleteKey",Escape:"EscapeKey",Esc:"EscapeKey",ArrowLeft:"ArrowLeftKey",Left:"ArrowLeftKey",ArrowUp:"ArrowUpKey",Up:"ArrowUpKey",ArrowRight:"ArrowRightKey",Right:"ArrowRightKey",ArrowDown:"ArrowDownKey",Down:"ArrowDownKey"},gt={ArrowLeftKey:!0,ArrowRightKey:!0,ArrowUpKey:!0,ArrowDownKey:!0};let ft,vt;class RendererBase{constructor(e){this.DOM_EMIT=this.emitComponentEvent,this.component=e}afterRender(e){this.component.managedState&&this.component.emit(ut);let t=this._renderedElement;t&&"revealing"===t.dataset.transitionT&&setTimeout((()=>{"revealing"===t.dataset.transitionT&&(t.dataset.transitionT="revealed")}),0)}emitComponentEvent(e,t){if(("click"===e.type||"mousedown"===e.type||"mouseup"===e.type)&&DOMRenderContext.$touchData.last>Date.now()-1e3)return;"submit"===e.type&&e.preventDefault();let n=t||function(e){return pt[e.type]}(e);if(this._emitUIEvent(n,e),"TouchStart"===n&&(DOMRenderContext.$touchData.last=Date.now(),ft=this,vt||window.addEventListener("touchmove",vt=()=>{window.removeEventListener("touchmove",vt),vt=void 0,ft=void 0}),this._emitUIEvent("MouseDown",e)),"TouchEnd"===n&&(DOMRenderContext.$touchData.last=Date.now(),ft===this&&(this._emitUIEvent("MouseUp",e),this._emitUIEvent("Click",e))),"KeyDown"===n){let t=e.key,n=t?mt[t]:"",i=!1;if("EnterKey"===n){let t=e.target,n=String(t.nodeName).toLowerCase();i="button"===n||"textarea"===n}!gt[n]||"list"!==this.component.accessibleRole&&"listitem"!==this.component.accessibleRole||e.preventDefault(),!i&&n&&setTimeout((()=>{this._emitUIEvent(n+"Press",e)}),0)}e.stopPropagation()}_emitUIEvent(e,t){this.component&&this.component.managedState&&this.component.emit(UIComponentEvent,e,this.component,void 0,t)}handleRenderEvent(e){if(e.source!==this.component)return;let t=!this._renderedElement,n=this._renderedElement||(this._renderedElement=this.createElement());n[Ge]=this;let i=this.component;i.accessibleRole&&n.setAttribute("role",i.accessibleRole),i.accessibleLabel&&n.setAttribute("aria-label",i.accessibleLabel),!BrowserApplication.transitionsDisabled&&i instanceof UICell&&(t&&i.revealTransition&&(n.dataset.transitionReveal=i.revealTransition,n.dataset.transitionT="revealing"),i.exitTransition&&(n.dataset.transitionExit=i.exitTransition,n.dataset.transitionT="revealing"));let o=i.lastRenderOutput&&i.lastRenderOutput.element===n?i.lastRenderOutput:i.lastRenderOutput=new UIRenderContext.Output(i,n);this._lastRenderCallback=e.renderCallback(o,this.afterRender.bind(this))}handleFocusRequestEvent(t){if(t.source===this.component&&this.component.lastRenderOutput){let n=this.component.lastRenderOutput.element;if(t.direction===e.UIFocusRequestType.SELF)return void n.focus();let i=this.component.getParentComponent(UIComponent),o=i&&i instanceof UIComponent&&i.lastRenderOutput&&i.lastRenderOutput.element;if(!o)return;let r=o.querySelectorAll("[tabIndex]");if(t.direction===e.UIFocusRequestType.REVERSE)for(let e=r.length-1;e>=0;e--){let t=n.compareDocumentPosition(r[e]);if(t&Node.DOCUMENT_POSITION_PRECEDING){let n=0;for(;n<e&&(t=r[n].compareDocumentPosition(r[e]),!(t&Node.DOCUMENT_POSITION_CONTAINED_BY));)n++;return void r[n].focus()}}else for(let e=0;e<r.length;e++){let t=n.compareDocumentPosition(r[e]);if(t&Node.DOCUMENT_POSITION_FOLLOWING&&!(t&Node.DOCUMENT_POSITION_CONTAINED_BY))return void r[e].focus()}}}updateElement(e){if(this._renderedElement=e,this._lastRenderCallback){let t=new UIRenderContext.Output(this.component,e);this.component.lastRenderOutput=t,this._lastRenderCallback=this._lastRenderCallback.call(void 0,t,this.afterRender.bind(this))}}scheduleStyleUpdate(e){this._addClass=e,this._renderedElement&&!this._sched&&(this._sched=!0,Promise.resolve().then((()=>{this._sched=!1,this._renderedElement&&Le(this.component,this._renderedElement,!1,this._addClass)})))}getElement(){return this._renderedElement}isRendered(){return!!this._lastRenderCallback&&!!this._renderedElement}}class UILabelRenderer extends RendererBase{constructor(e){super(e),this.component=e,this.DOM_CONTROL_EMIT=this.DOM_EMIT}createElement(){let e=document.createElement(this.component.headingLevel?"h"+this.component.headingLevel:"span");return this.component.isKeyboardFocusable()?e.tabIndex=0:this.component.isFocusable()&&(e.tabIndex=-1),Le(this.component,e,!0),yt(e,{text:this.component.text,htmlFormat:this.component.htmlFormat,icon:this.component.icon,iconColor:this.component.iconColor||this.component.textStyle.color,iconSize:this.component.iconSize,iconMargin:this.component.iconMargin,iconAfter:this.component.iconAfter}),e}onUIRender(e){this.handleRenderEvent(e)}onUIFocusRequestAsync(e){this.handleFocusRequestEvent(e)}setText(){let e=this.getElement();e&&yt(e,{text:this.component.text,htmlFormat:this.component.htmlFormat,icon:this.component.icon,iconColor:this.component.iconColor||this.component.textStyle.color,iconSize:this.component.iconSize,iconMargin:this.component.iconMargin,iconAfter:this.component.iconAfter})}onHeadingLevelChange(){this.isRendered()&&this.updateElement(this.createElement())}updateStyle(){this.scheduleStyleUpdate()}}function yt(e,t){let n=null==t.text?"":String(t.text);if(!t.icon)return void(t.htmlFormat?e.innerHTML=n:e.textContent=n);let i=document.createElement("span");i.style.display="flex",i.style.flexDirection="row",i.style.alignItems="center",i.style.justifyContent="space-around",i.style.textOverflow="inherit";try{let e=function(e){let t=Fe(e.iconSize,"1rem"),n=e.iconColor?UITheme.replaceColor(e.iconColor):"",i=e.icon+":"+t+":"+n;if(Ct[i])return Ct[i].cloneNode(!0);let o,r=document.createElement("div");r.innerHTML=UITheme.current.icons[e.icon]||e.icon;let s=r.firstChild;if(s||(s=document.createTextNode("")),"svg"===String(s.nodeName).toLowerCase())o=s,o.hasAttribute("stroke")?o.style.stroke=n||"currentColor":o.style.fill=n||"currentColor",o.style.display="inline-block",o.style.width=t,o.style.height="auto";else{let i=document.createElement("icon");i.style.display="inline-block",i.appendChild(s),e.iconSize&&(i.style.fontSize=t),n&&(i.style.color=n),o=i}return o.style.flex="0 0 "+t,o.style.width=t,Ct[i]=o.cloneNode(!0),o}(t);e.style.order=t.iconAfter?"2":"0",i.appendChild(e)}catch(e){bt[t.icon]||(bt[t.icon]=!0,M(e))}if(n){let e=Fe(t.iconMargin,".5rem"),o=document.createElement("span");o.style.flex="0 0 "+e,o.style.width=e,o.style.order="1",i.appendChild(o);let r=document.createElement("span");r.style.flex="1 0 0",r.style.order=t.iconAfter?"0":"2",r.style.textOverflow="inherit",r.style.overflow="hidden",t.htmlFormat?r.innerHTML=n:r.textContent=n,i.appendChild(r),i.style.justifyContent="start"}e.innerHTML="",e.appendChild(i)}t([f("text","htmlFormat","icon","iconColor","iconSize","iconMargin","iconAfter")],UILabelRenderer.prototype,"setText",null),t([f("hidden","style","shrinkwrap","disabled","textStyle","decoration","dimensions","position")],UILabelRenderer.prototype,"updateStyle",null);let bt={};const Ct={};UILabel.addObserver(UILabelRenderer);class UIButtonRenderer extends RendererBase{constructor(e){super(e),this.component=e,this.DOM_CONTROL_EMIT=this.DOM_EMIT}createElement(){let e="link"===this.component.accessibleRole,t=document.createElement(e?"a":"button");return e||(t.type="button"),t.tabIndex=this.component.isKeyboardFocusable()?0:-1,Le(this.component,t,!0),yt(t,{text:this.component.label,icon:this.component.icon,iconColor:this.component.iconColor,iconSize:this.component.iconSize,iconMargin:this.component.iconMargin,iconAfter:this.component.iconAfter}),(this.component.navigateTo||this.component.navigationTarget)&&(t.href=wt(this.component,String(this.component.getNavigationTarget()))),this.component.disabled&&t.setAttribute("disabled","disabled"),t.addEventListener("click",(e=>{(this.component.navigateTo||this.component.navigationTarget)&&(e.ctrlKey||e.altKey||e.metaKey?(e.stopPropagation(),e.stopImmediatePropagation()):(e.preventDefault(),this.component.disabled||this.component.emitAction("Navigate")))})),t}onUIRender(e){this.handleRenderEvent(e)}onUIFocusRequestAsync(e){this.handleFocusRequestEvent(e)}setText(){let e=this.getElement();e&&yt(e,{text:this.component.label,icon:this.component.icon,iconColor:this.component.iconColor,iconSize:this.component.iconSize,iconMargin:this.component.iconMargin,iconAfter:this.component.iconAfter})}setHref(){let e=this.getElement();e&&(e.href=wt(this.component,String(this.component.getNavigationTarget())))}onDisabledChange(){let e=this.getElement();e&&(this.component.disabled?e.setAttribute("disabled","disabled"):e.removeAttribute("disabled"))}onSelect(){let e=this.getElement();e&&(e.dataset.selected="selected")}onDeselect(){let e=this.getElement();e&&delete e.dataset.selected}updateStyle(){this.scheduleStyleUpdate()}}function wt(e,t){let n=e.getParentComponent(BrowserApplication),i=n&&n.activationContext;return i&&i.getPathHref&&i.getPathHref(t)||""}t([f("label","icon","iconColor","iconSize","iconMargin","iconAfter")],UIButtonRenderer.prototype,"setText",null),t([f("navigateTo","navigationTarget")],UIButtonRenderer.prototype,"setHref",null),t([f("hidden","style","shrinkwrap","textStyle","decoration","dimensions","position")],UIButtonRenderer.prototype,"updateStyle",null),UIButton.addObserver(UIButtonRenderer);class UICellRenderer{constructor(e){this.component=e}updateStyle(){var e;if(this._sched)return;let t=null===(e=this.component.lastRenderOutput)||void 0===e?void 0:e.element;t&&(this._sched=!0,Promise.resolve().then((()=>{this._sched=!1,Le(this.component,t)})))}}t([f("css","decoration","margin","background","textDirection","textColor","borderThickness","borderColor","borderStyle","borderRadius","dropShadow","opacity")],UICellRenderer.prototype,"updateStyle",null),UICell.addObserver(UICellRenderer);let It=16;class DOMContainerUpdater{constructor(e,t){this._content={},this.element=e,t&&(this.separator=Object.assign({},t))}setAsyncCreate(e){this._asyncChildren=!!e}setAnimationTimeMs(e){this._animationTimeMs=e}setAnimationSpeed(e){this._animationSpeed=e,e>0?this._animationTimeMs||(this._animationTimeMs=5e3):this._animationTimeMs=0}stop(){this._stopped=!0}update(e){if(!this.element)return;if(this._updatePending)return void(this._updatePending=e);this._updatePending=e;let t=DOMRenderContext.scheduleRender((()=>{if(this._stopped||!this._updatePending)return;e=this._updatePending,this._updatePending=void 0,this._rendered||(this._rendered=!0,this.element.innerHTML="");let n=!!this._animationTimeMs;if(n){this._animatePositions={};let e=this._animatePositions,t=this.element.firstChild;for(;t;)t.getBoundingClientRect&&!t.dataset.uiRemoved&&(e[t.dataset.uiAnimateId||(t.dataset.uiAnimateId="anim_"+It++)]=t.getBoundingClientRect()),t=t.nextSibling}let i=[],o={};for(let n of e){let e=n.managedId,r=this._content[e]||this._addChildComponent(n,t);o[e]=r,i.push(r.element),r.element&&r.element.parentNode&&r.element.parentNode!==this.element&&(r.detach&&r.detach(),r.element.parentNode&&r.element.parentNode.removeChild(r.element)),r.detach=()=>{if(r.element&&r.element.parentNode===this.element){let t=this._content[e]=this._getPlaceholder(n);r.element.parentNode.replaceChild(t.element,r.element)}}}let r={};for(let e in this._content)o[e]||(r[e]=this._content[e]);this._content=o;for(let e in r){let t=r[e].element;if(t.parentNode===this.element){let e;this.separator&&(e=t.previousSibling,e&&!e.dataset.uiRemoved||(e=t.nextSibling)),st(t),e&&st(e)}}let s=this.element.lastChild;for(;s&&s.dataset&&s.dataset.uiRemoved;)s=s.previousSibling;let a=s&&s.nextSibling;for(let e=i.length-1;e>=0;e--){let t=i[e];if(!t.parentNode||t.nextSibling!==a){let e=this.separator&&(t.previousSibling||this._makeSeparator());if(this.element.insertBefore(t,a),e){let n=t.previousSibling;!n||n.dataset&&n.dataset.uiRemoved?t.nextSibling&&this.element.insertBefore(e,t.nextSibling):this.element.insertBefore(e,t)}}for(a=t,this.separator&&t.previousSibling&&!t.previousSibling.dataset.uiRemoved&&(a=t.previousSibling);a.previousSibling&&a.previousSibling.dataset&&a.previousSibling.dataset.uiRemoved;)a=a.previousSibling}n&&this._animateElements()}))}_makeSeparator(){if(!this.separator)throw Error;let e;if(this.separator.lineThickness){let t=Fe(this.separator.lineThickness,""),n=Fe(this.separator.lineMargin,"");e=document.createElement("hr"),e.className="UIRender__Separator--line"+(this.separator.vertical?" UIRender__Separator--line-vertical":""),e.style.borderWidth=t,e.style.margin=n?this.separator.vertical?"0 "+n:n+" 0":"",e.style.borderColor=UITheme.replaceColor(this.separator.lineColor||"@separator")}else{let t=Fe(this.separator.space,"0");e=document.createElement("spacer"),e.className="UIRender__Separator--spacer",!1!==this.separator.vertical&&(e.style.width=t),this.separator.vertical||(e.style.height=t)}return e}_addChildComponent(e,t){let n,i=e.managedId,o=!1,r=(s,a)=>(n||!s||o?DOMRenderContext.scheduleRender((()=>{if(this._stopped||!e.managedState)return s;if(n&&n!==s&&n.element.parentNode===this.element){if(s&&s.element){if(s.element.parentNode){let t=this._getPlaceholder(e),n=s.element;n.parentNode.replaceChild(t.element,n),s.element=t.element,t.element=n,s=t}}else s=this._getPlaceholder(e);this.element.replaceChild(s.element,n.element),this._content[i]=n=s}return s})).then(a).catch(M):(this._content[i]=n=s,t.then((()=>a&&a(s))).catch(M)),r);return this._asyncChildren?DOMRenderContext.scheduleRender((()=>{e.render(r)}),!0):e.render(r),n||(n=this._content[i]=this._getPlaceholder(e)),o=!0,n}_getPlaceholder(e){let t=document.createElement("placeholder");return t.id="placeholder:"+e.managedId,t.hidden=!0,new UIRenderContext.Output(e,t)}_animateElements(e=!0){if(!this._animatePositions)return;let t=this._animationTimeMs,n=this._animationSpeed?this._animationSpeed*(window.innerHeight+window.innerWidth)/2e3:1,i=[],o=[],r=[],s=[],a=[],l=this.element.firstChild;for(;l;){if(l.dataset)if(l.dataset.uiAnimateId&&!l.dataset.uiRemoved)l.style.transition="transform 0s",l.style.transform="";else if(l.dataset.uiRemoved){let e=l;if(l.dataset.transitionExit){let t=l.getBoundingClientRect();s.push((()=>{e.style.position="fixed",e.style.top=t.top+"px",e.style.left=t.left+"px",e.style.width=t.width+"px",e.style.height=t.height+"px"}))}else s.push((()=>{e.style.display="none"})),a.push((()=>{e.style.display=""}))}l=l.nextSibling}for(s.forEach((e=>e())),l=this.element.firstChild;l;){if(!l.dataset.uiRemoved)if(l.dataset&&l.dataset.uiAnimateId&&this._animatePositions[l.dataset.uiAnimateId]){let e=l.getBoundingClientRect(),r=this._animatePositions[l.dataset.uiAnimateId],s=Math.floor(r.left-e.left),a=Math.floor(r.top-e.top);i.push(l);let c=Math.floor(Math.min(t,Math.abs(s+a)/n));o.push(c),l.style.transform="translateX("+s+"px) translateY("+a+"px)"}else if(e&&l.getBoundingClientRect){let e=l.getBoundingClientRect();(e.height<1||e.width<1)&&r.push(l)}l=l.nextSibling}setTimeout((()=>{for(let e=i.length-1;e>=0;e--)i[e].style.transition="transform "+o[e]+"ms ease-in-out",i[e].style.transform="";for(let e of r){let t=e.getBoundingClientRect();if(t.width>=1&&t.height>=1)return void setTimeout((()=>{this._animateElements(!1)}),0)}setTimeout((()=>{for(let e of i)e.style.transform="",e.style.transition=""}),100)}),0),a.forEach((e=>e()))}}const _t={};class UIContainerRenderer extends RendererBase{constructor(e){super(e),this.component=e,e instanceof UICell&&(this.DOM_CELL_EMIT=this.DOM_EMIT)}createElement(){let e=document.createElement("form"===this.component.accessibleRole?"form":"container");return this.component.isKeyboardFocusable()?e.tabIndex=0:this.component.isFocusable()&&(e.tabIndex=-1),Le(this.component,e,!0),e}afterRender(){if(super.afterRender(),this.component.managedState&&this.component instanceof UIScrollContainer){let e=this.component;if(this.isRendered()){let t,n,i,o,r=this.getElement(),s=0,a=0,l=0,c=Date.now(),d=!1,h=()=>{let u=(Date.now()-c)/1e3,p=r.scrollTop-s,m=Math.abs(r.scrollLeft)-Math.abs(a);p<0&&(n=!(t=!0)),p>0&&(n=!(t=!1)),m<0&&(o=!(i=!0)),m>0&&(o=!(i=!1)),s=r.scrollTop,a=r.scrollLeft,c=Date.now();const g=l=>{let c=new UIScrollEvent(l,e);return c.yOffset=s,c.xOffset=a,a=Math.abs(a),c.scrolledDown=n,c.scrolledUp=t,c.scrolledHorizontalStart=i,c.scrolledHorizontalEnd=o,c.atTop=s<=e.topThreshold,c.atHorizontalStart=a<=e.horizontalThreshold,c.atBottom=s+r.clientHeight>=r.scrollHeight-e.bottomThreshold,c.atHorizontalEnd=a+r.clientWidth>=r.scrollWidth-e.horizontalThreshold,c.verticalVelocity=Math.abs(p/(window.innerHeight||1))/(u||.1),c.horizontalVelocity=Math.abs(m/(window.innerWidth||1))/(u||.1),c.freeze()};e.managedState&&(e.emit(g("Scroll")),l<c-200?(e.emit(g("ScrollEnd")),d=!1):(setTimeout(h,250),d=!0))};r.onscroll=e=>{l=Date.now(),d||h()}}}}onUIRender(e){this.handleRenderEvent(e),this._separator=this._getSeparator(),this._refreshUpdater()}onUIFocusRequestAsync(e){this.handleFocusRequestEvent(e)}onFocusIn(e){if(e.source!==this.component&&this.component.isKeyboardFocusable()){let t=this.getElement();t&&(t.tabIndex=-1),this.lastFocused=e.source}}onFocusOut(e){if(e.source!==this.component&&this.component.isKeyboardFocusable()){let e=this.getElement();e&&(e.tabIndex=0),this.lastFocused=void 0}}onUIScrollTarget(e){let t=this.getElement();t&&("top"===e.target&&t.scrollTo({top:0}),"bottom"===e.target&&t.scrollTo({top:t.scrollHeight}),void 0!==e.yOffset&&t.scrollTo({top:e.yOffset}),void 0!==e.xOffset&&t.scrollTo({left:e.xOffset}))}onContentChangeAsync(){return n(this,void 0,void 0,(function*(){if(this.component.content){if(this._updater&&this._updater.update(this.component.content),this.component.isKeyboardFocusable()&&this.lastFocused&&!this.component.content.includes(this.lastFocused)){let e=this.getElement();e&&(e.tabIndex=0),this.lastFocused=void 0}}else this._updater&&(this._updater.stop(),this._updater=void 0)}))}onAsyncContentRenderingChange(){this._updater&&this._updater.setAsyncCreate(this.component.asyncContentRendering)}onAnimatedContentRenderingDurationChange(){this._updater&&this._updater.setAnimationTimeMs(this.component.animatedContentRenderingDuration||0)}onAnimatedContentRenderingVelocityChange(){this._updater&&this._updater.setAnimationSpeed(this.component.animatedContentRenderingVelocity||0)}updateStyle(){this.scheduleStyleUpdate();let e=this._getSeparator();this._separator!==e&&(this._separator=e,this._refreshUpdater())}onScrollEnd(e){let t=this.getElement();if(t&&this.component instanceof UIScrollContainer){let n,i=this.component,o=t.getBoundingClientRect(),r=document.activeElement,s=[],a=t.firstChild;for(;a;){if(a.getBoundingClientRect){let e=a.getBoundingClientRect();e.bottom>o.top&&e.top<o.bottom&&(a===r&&(n=e),s.push(e))}a=a.nextSibling}if("ScrollEnd"===e.name||"ScrollSnapUp"===e.name||"ScrollSnapDown"===e.name){let r,a=o.height,l="ScrollEnd"===e.name?0:"ScrollSnapUp"===e.name?.25:-.25;switch(i.verticalSnap){case"start":for(let e of s){let t=e.top+l*e.height,i=Math.abs(t-o.top);e===n&&(i-=e.height/2),i<a&&(r=e.top,a=i)}break;case"end":for(let e of s){let t=e.bottom+l*e.height,i=Math.abs(t-o.bottom);e===n&&(i-=e.height/2),i<a&&(r=e.bottom-o.height,a=i)}break;case"center":let e=o.top+o.height/2;for(let t of s){let i=t.top+t.height/2+l*t.height,s=Math.abs(i-e);t===n&&(s-=t.height/2),s<a&&(r=i-o.height/2,a=s)}}if(null!=r){let e=t.scrollTop+(r-o.top);t.scrollTo({behavior:"smooth",top:e})}}if("ScrollEnd"===e.name||"ScrollSnapStart"===e.name||"ScrollSnapEnd"===e.name){let r,a=o.width,l="ScrollEnd"===e.name?0:"ScrollSnapStart"===e.name?.25:-.25;switch(i.horizontalSnap){case"start":for(let e of s){let t=e.left+l*e.width,i=Math.abs(t-o.left);e===n&&(i-=e.width/2),i<a&&(r=e.left,a=i)}break;case"end":for(let e of s){let t=e.right+l*e.width,i=Math.abs(t-o.right);e===n&&(i-=e.width/2),i<a&&(r=e.right-o.width,a=i)}break;case"center":let e=o.left+o.width/2;for(let t of s){let i=t.left+t.width/2+l*t.width,s=Math.abs(i-e);t===n&&(s-=t.width/2),s<a&&(r=i-o.width/2,a=s)}}if(null!=r){let e=t.scrollLeft+(r-o.left);t.scrollTo({behavior:"smooth",left:e})}}}}onScrollSnapUp(e){"start"===this.component.verticalSnap&&this.onScrollEnd(e)}onScrollSnapDown(e){"end"===this.component.verticalSnap&&this.onScrollEnd(e)}onScrollSnapStart(e){"start"===this.component.horizontalSnap&&this.onScrollEnd(e)}onScrollSnapEnd(e){"end"===this.component.horizontalSnap&&this.onScrollEnd(e)}onSelect(e){if(e.source!==this.component)return;let t=this.getElement();t&&(t.dataset.selected="selected")}onDeselect(e){if(e.source!==this.component)return;let t=this.getElement();t&&delete t.dataset.selected}_refreshUpdater(){let e=this.getElement();e&&(this._updater&&this._updater.stop(),this._updater=new DOMContainerUpdater(e,this._separator),this.component.asyncContentRendering&&this._updater.setAsyncCreate(!0),this.component.animatedContentRenderingDuration>=0&&this._updater.setAnimationTimeMs(this.component.animatedContentRenderingDuration),this.component.animatedContentRenderingVelocity>=0&&this._updater.setAnimationSpeed(this.component.animatedContentRenderingVelocity),this._updater.update(this.component.content))}_getSeparator(){if(!this.component.layout)return;let e=this.component.layout.separator;if(!e&&"function"==typeof(t=this.component).hasComponentSpacing&&t.hasComponentSpacing()){let t=this.component.spacing,n=this.component.layout.axis,i=t+"|"+n;e=_t[i]||(_t[i]={space:t,vertical:"horizontal"===n})}var t;return e}}let St;t([f("hidden","style","layout","spacing","dimensions","position","padding","height","width","verticalScrollEnabled","horizontalScrollEnabled")],UIContainerRenderer.prototype,"updateStyle",null),UIContainer.addEventHandler((function(e){if("DragContainer"===e.name){if(St>Date.now()-40||this.getParentComponent()instanceof UIComponent)return;let t,n=this.lastRenderOutput&&this.lastRenderOutput.element;if(!n)return;for(;e&&!t;)if(e instanceof UIComponentEvent&&e.event)t=e.event;else{if(!(e instanceof ComponentEvent&&e.inner))break;e=e.inner}if(!t||t.button)return;let i=t.touches&&t.touches[0].screenX||t.screenX,o=t.touches&&t.touches[0].screenY||t.screenY;if(void 0===i||void 0===o)return;St=Date.now();let r=!1,s=n.getBoundingClientRect();const a=e=>{let t=e.touches&&e.touches[0].screenX||e.screenX,a=e.touches&&e.touches[0].screenY||e.screenY,l=t-i,c=a-o;if(!r){if(Math.abs(l)<2&&Math.abs(c)<2)return;r=!0;let e=n.parentNode;e&&"App__ModalWrapper"===e.className&&(e.style.top="0",e.style.left="0"),n.style.position="absolute",n.style.bottom="auto",n.style.right="auto"}e.preventDefault(),e.stopPropagation();let d=Math.max(0,s.top+c);n.style.top=Math.min(d,window.innerHeight-40)+"px";let h=Math.max(40-n.clientWidth,s.left+l);n.style.left=Math.min(h,window.innerWidth-64)+"px"},l=e=>{r&&(e.preventDefault(),e.stopPropagation()),St=0,DOMRenderContext.scheduleRender((()=>{window.removeEventListener("touchmove",a,{passive:!1,capture:!0}),window.removeEventListener("mousemove",a,!0),window.removeEventListener("touchend",l,!0),window.removeEventListener("mouseup",l,!0),window.removeEventListener("click",l,!0)}))};window.addEventListener("touchmove",a,{passive:!1,capture:!0}),window.addEventListener("mousemove",a,!0),window.addEventListener("touchend",l,!0),window.addEventListener("mouseup",l,!0),window.addEventListener("click",l,!0)}})),UIContainer.addObserver(UIContainerRenderer);class UIImageRenderer extends RendererBase{constructor(e){super(e),this.component=e,this.DOM_CONTROL_EMIT=this.DOM_EMIT}createElement(){let e=document.createElement("img");return e.onerror=e=>{this.component.managedState&&this.component.emit(UIComponentEvent,"LoadError",this.component,void 0,e)},this.component.isKeyboardFocusable()?e.tabIndex=0:this.component.isFocusable()&&(e.tabIndex=-1),Le(this.component,e,!0),e.src=String(this.component.url||""),e}onUIRender(e){this.handleRenderEvent(e)}onUIFocusRequestAsync(e){this.handleFocusRequestEvent(e)}onUrlChange(){let e=this.getElement();e&&(e.src=String(this.component.url||""))}updateStyle(){this.scheduleStyleUpdate()}}t([f("hidden","style","shrinkwrap","disabled","textStyle","decoration","dimensions","position")],UIImageRenderer.prototype,"updateStyle",null),UIImage.addObserver(UIImageRenderer);class UISeparatorRenderer extends RendererBase{constructor(e){super(e),this.component=e}createElement(){let e=document.createElement("hr"),t="UIRender__Separator--line"+(this.component.vertical?" UIRender__Separator--line-vertical":"");if(Le(this.component,e,!0,t),this.component.margin){let t=Fe(this.component.margin);e.style.margin=this.component.vertical?"0 "+t:t+" 0"}return e}onUIRender(e){this.handleRenderEvent(e)}updateStyle(){this.scheduleStyleUpdate("UIRender__Separator--line"+(this.component.vertical?" UIRender__Separator--line-vertical":""))}}t([f("hidden","style","vertical","dimensions","color","thickness","margin","position")],UISeparatorRenderer.prototype,"updateStyle",null),UISeparator.addObserver(UISeparatorRenderer);class UISpacerRenderer extends RendererBase{constructor(e){super(e),this.component=e}createElement(){let e=document.createElement("spacer");return Le(this.component,e,!0),e}onUIRender(e){this.handleRenderEvent(e)}updateStyle(){this.scheduleStyleUpdate()}}t([f("hidden","style","shrinkwrap","decoration","dimensions","position")],UISpacerRenderer.prototype,"updateStyle",null),UISpacer.addObserver(UISpacerRenderer);class UITextFieldRenderer extends RendererBase{constructor(e){super(e),this.component=e,this.DOM_CONTROL_EMIT=this.DOM_EMIT}createElement(){let e=document.createElement(this.component.multiline?"textarea":"input");e.tabIndex=this.component.isKeyboardFocusable()?0:-1,this.component.multiline||(e.type=this.component.type),e.placeholder=String(this.component.placeholder||" ");let t=this.component.value;return e.value=null==t?"":String(t),this.component.name&&(e.name=this.component.name),this.component.disabled&&(e.disabled=!0),this.component.enterKeyHint&&(e.enterKeyHint=this.component.enterKeyHint),Le(this.component,e,!0),e}emitComponentEvent(e){let t=this.getElement();t&&(this.component.value=t.value),super.emitComponentEvent(e)}onUIRender(e){this.handleRenderEvent(e)}onUIFocusRequestAsync(e){this.handleFocusRequestEvent(e)}onMultilineChange(){this.isRendered()&&this.updateElement(this.createElement())}updateControl(){let e=this.getElement();if(e){let t=String(this.component.placeholder||" ");e.placeholder!==t&&(e.placeholder=t),this.component.multiline||e.type===this.component.type||(e.type=this.component.type),this.component.name&&(e.name=this.component.name),this.component.enterKeyHint&&(e.enterKeyHint=this.component.enterKeyHint);let n=this.component.value;n=null==n?"":String(n),e.value!=n&&(e.value=n)}}onDisabledChange(){let e=this.getElement();e&&(e.disabled=!!this.component.disabled)}updateStyle(){this.scheduleStyleUpdate()}}t([f("name","value","type","placeholder","enterKeyHint")],UITextFieldRenderer.prototype,"updateControl",null),t([f("hidden","style","shrinkwrap","textStyle","decoration","dimensions","position")],UITextFieldRenderer.prototype,"updateStyle",null),UITextField.addObserver(UITextFieldRenderer);class UIToggleRenderer extends RendererBase{constructor(e){super(e),this.component=e,this.DOM_CONTROL_EMIT=this.DOM_EMIT}createElement(){let e=document.createElement("span"),t=document.createElement("input");t.tabIndex=this.component.isKeyboardFocusable()?0:-1,t.type="checkbox",t.checked=!!this.component.state,t.id="UIToggle::"+this.component.managedId,t.name=this.component.name||"UIToggle::"+this.component.managedId,this.component.disabled&&(t.disabled=!0);let n=document.createElement("label");return n.htmlFor="UIToggle::"+this.component.managedId,this._setLabelContent(n),e.appendChild(t),e.appendChild(n),Le(this.component,e,!0),e}emitComponentEvent(e){let t=this.getElement();if(t){let e=t.firstChild;this.component.state=!!e.checked}super.emitComponentEvent(e)}onUIRender(e){this.handleRenderEvent(e)}onUIFocusRequestAsync(e){this.handleFocusRequestEvent(e)}updateControl(){let e=this.getElement();if(e){let t=e.firstChild;this.component.name&&(t.name=this.component.name),t.checked&&!this.component.state?t.checked=!1:!t.checked&&this.component.state&&(t.checked=!0)}}onLabelChange(){let e=this.getElement();e&&this._setLabelContent(e.lastChild)}onDisabledChange(){let e=this.getElement();e&&(e.firstChild.disabled=!!this.component.disabled)}_setLabelContent(e){e.innerHTML="";let t=document.createElement("control");this.component.highlightColor&&(t.style.background=UITheme.replaceColor(this.component.highlightColor));let n=this.component.label;n=null==n?"":String(n),e.textContent=n?"  "+n:"",e.insertBefore(t,e.firstChild)}updateStyle(){this.scheduleStyleUpdate()}onHighlightColorChangeAsync(){let e=this.getElement();if(e){let t=e.firstChild.nextSibling,n=UITheme.replaceColor(this.component.highlightColor||"transparent");t.style.background=n}}}t([f("name","state")],UIToggleRenderer.prototype,"updateControl",null),t([f("hidden","style","shrinkwrap","disabled","textStyle","decoration","dimensions","position")],UIToggleRenderer.prototype,"updateStyle",null),UIToggle.addObserver(UIToggleRenderer),e.ActionEvent=ActionEvent,e.AppActivationContext=AppActivationContext,e.AppActivity=AppActivity,e.AppActivityList=AppActivityList,e.AppComponent=AppComponent,e.AppException=AppException,e.Application=Application,e.Binding=Binding,e.BrowserApplication=BrowserApplication,e.BrowserTheme=BrowserTheme,e.CHANGE=a,e.Component=Component,e.ComponentChildAddedEvent=class ComponentChildAddedEvent extends ManagedEvent{constructor(e){super("ChildComponentAdded"),this.source=e.component,this.observer=e}},e.ComponentEvent=ComponentEvent,e.CompositeParentChangeEvent=class CompositeParentChangeEvent extends ManagedEvent{constructor(e,t){super("CompositeParentChange"),this.source=e,this.composite=t}},e.ConfirmationDialogBuilder=ConfirmationDialogBuilder,e.DialogViewActivity=DialogViewActivity,e.I18nService=I18nService,e.I18nString=I18nString,e.JSX=Oe,e.ManagedChangeEvent=ManagedChangeEvent,e.ManagedCoreEvent=ManagedCoreEvent,e.ManagedEvent=ManagedEvent,e.ManagedList=ManagedList,e.ManagedListChangeEvent=ManagedListChangeEvent,e.ManagedMap=ManagedMap,e.ManagedObject=ManagedObject,e.ManagedObjectAddedEvent=ManagedObjectAddedEvent,e.ManagedObjectRemovedEvent=ManagedObjectRemovedEvent,e.ManagedParentChangeEvent=ManagedParentChangeEvent,e.ManagedRecord=ManagedRecord,e.ManagedReference=ManagedReference,e.ManagedService=ManagedService,e.ModalViewActivity=ModalViewActivity,e.NavigationTarget=class NavigationTarget{constructor(e,t){this.title=t,e instanceof AppActivity?(this._activity=e,void 0===t&&e.name&&(this.title=e.name)):this._path=String(e)}toString(){let e=String((this._activity?this._activity.path:this._path)||""),t=this._activity;for(;t&&"."===e[0]&&"/"===e[1];)t=t.getParentActivity(),t instanceof AppActivity&&"string"==typeof t.path&&(e=t.path.replace(/\/$/,"")+e.slice(1));return e}},e.PageViewActivity=class PageViewActivity extends ViewActivity{constructor(){super(...arguments),this.placement=e.UIRenderPlacement.PAGE}},e.StringFormatBinding=StringFormatBinding,e.UIBeforeRenderEvent=UIBeforeRenderEvent,e.UIBorderlessButton=le,e.UIBorderlessTextField=Ie,e.UIButton=UIButton,e.UICell=UICell,e.UICenterRow=re,e.UICloseColumn=Z,e.UICloseLabel=ye,e.UICloseRow=se,e.UIColor=UIColor,e.UIColumn=UIColumn,e.UIComponent=UIComponent,e.UIComponentEvent=UIComponentEvent,e.UIConditional=UIConditional,e.UIContainer=UIContainer,e.UIControl=UIControl,e.UICoverCell=Q,e.UIExpandedLabel=be,e.UIFlowCell=J,e.UIFocusRequestEvent=UIFocusRequestEvent,e.UIForm=UIForm,e.UIFormContext=UIFormContext,e.UIFormContextChangeEvent=UIFormContextChangeEvent,e.UIFormContextController=UIFormContextController,e.UIHeading1=me,e.UIHeading2=ge,e.UIHeading3=fe,e.UIIconButton=pe,e.UIImage=UIImage,e.UILabel=UILabel,e.UILargeButton=he,e.UILinkButton=de,e.UIListCellAdapter=UIListCellAdapter,e.UIListCellAdapterEvent=UIListCellAdapterEvent,e.UIListController=UIListController,e.UIMenu=UIMenu,e.UIMenuBuilder=UIMenuBuilder,e.UIMenuItemSelectedEvent=UIMenuItemSelectedEvent,e.UIModalController=UIModalController,e.UIOppositeRow=oe,e.UIOutlineButton=ce,e.UIParagraph=ve,e.UIPrimaryButton=ae,e.UIRenderContext=UIRenderContext,e.UIRenderEvent=UIRenderEvent,e.UIRenderableController=UIRenderableController,e.UIRow=UIRow,e.UIScrollContainer=UIScrollContainer,e.UIScrollEvent=UIScrollEvent,e.UIScrollTargetEvent=UIScrollTargetEvent,e.UISelectionController=UISelectionController,e.UISeparator=UISeparator,e.UISmallButton=ue,e.UISpacer=UISpacer,e.UIStyle=UIStyle,e.UIStyleController=UIStyleController,e.UITextField=UITextField,e.UITheme=UITheme,e.UIToggle=UIToggle,e.UIViewRenderer=UIViewRenderer,e.UnhandledErrorEmitter=UnhandledErrorEmitter,e.UnhandledErrorEvent=UnhandledErrorEvent,e.ViewActivity=ViewActivity,e.ViewComponent=ViewComponent,e.activationContextBinding=xe,e.autoUpdateHandler=at,e.bind=F,e.bindf=function(e,...t){return new StringFormatBinding(e,...t)},e.component=N,e.delegateEvents=z,e.formContextBinding=Ce,e.logUnhandledException=M,e.managed=x,e.managedChild=U,e.observe=m,e.onPropertyChange=f,e.onPropertyEvent=function(...e){return function(t,n){let i=t[n];if("function"!=typeof i)throw TypeError();i["^o:prop"]||(i["^o:prop"]=[]);let o=i["^o:prop"];for(let t of e)o.some((e=>e==="!"+t))||o.push("!"+t)}},e.rateLimit=function(e){return function(t,n){if("function"!=typeof t[n]||"string"!=typeof n||"Async"!==n.slice(-5))throw r(39);t[n]["^o:rate"]=e}},e.renderContextBinding=ee,e.service=E,e.shadowObservable=g,e.strf=D,e.viewportContextBinding=te,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).typescene={});
